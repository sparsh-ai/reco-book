
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Retail Product Recommendation with Negative Implicit Feedback &#8212; Reco Book</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sequence Aware Recommender Systems" href="T315965_Sequence_Aware_Recommenders_Music.html" />
    <link rel="prev" title="Retail Product Recommendations using word2vec" href="T132203_Retail_Product_Recommendations_using_Word2vec.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Reco Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Tutorials in Jupyter notebook format
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  User Stories
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="US780867_Transformer_based_Recommenders.html">
   Transformer-based Recommenders
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="T034923_BERT4Rec_on_ML1M_in_PyTorch.html">
     BERT4Rec on ML-1M in PyTorch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T595874_BERT4Rec_on_ML25M_in_PyTorch_Lightning.html">
     BERT4Rec on ML-25M
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T088416_BST_Implementation_in_MXNet.html">
     BST Implementation in MXNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T602245_BST_implementation_in_PyTorch.html">
     BST implementation in PyTorch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T007665_BST_on_ML1M_in_Keras.html">
     A Transformer-based recommendation system
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T881207_BST_PTLightning_ML1M.html">
     Rating prediction using the Behavior Sequence Transformer (BST) model on ML-1M dataset in PyTorch Lightning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T757997_SASRec_PyTorch.html">
     SASRec implementation with PyTorch Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T225287_SASRec_PaddlePaddle.html">
     SASRec implementation with Paddle Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T701627_SR_SAN_Session_based_Model.html">
     SR-SAN Session-based Recommender
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T975104_SSEPT_ML1M_Tensorflow1x.html">
     SSE-PT Personalized Transformer Recommender on ML-1M in Tensorflow 1.x
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Prototypes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="T382881_DeepWalk_Karateclub.html">
   DeepWalk from scratch referencing Karateclub library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T384270_DeepWalk_pure_python.html">
   DeepWalk in pure python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T677598_Jaccard_Cosine_SVD_DeepWalk_ML100K.html">
   Recommender System with DeepWalk Graph Embeddings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T815556_Node2vec_Karateclub.html">
   Node2vec from scratch referencing Karateclub library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T894941_Node2vec_MovieLens_Keras.html">
   Graph representation learning with node2vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T611050_Node2vec_PyG.html">
   Node2vec from scratch in PyTorch Geometric
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T186367_Node2vec_library.html">
   Node2vec from scratch referencing node2vec library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T331379_bayesian_personalized_ranking.html">
   BPR from scratch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T081831_Data_Poisoning_Attacks_on_Factorization_Based_Collaborative_Filtering.html">
   Data Poisoning Attacks on Factorization-Based Collaborative Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T102448_Adversarial_Learning_for_Recommendation.html">
   Adversarial Training (Regularization) on a Recommender System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T865035_Simulating_Data_Poisoning_Attacks_against_Twitter_Recommender.html">
   Load and process dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T711285_Data_Poisoning_Attack_using_LFM_and_ItemAE_on_Synthetic_Dataset.html">
   Injection attack using LFM and ItemAE model trained on Toy dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T355514_Black_box_Attack_on_Sequential_Recs.html">
   Black-box Attack on Sequential Recs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T873451_Statistics_fundamentals.html">
   Statictics Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T890478_Batch_Learning_from_Bandit_Feedback_%28BLBF%29.html">
   Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T257798_Off_Policy_Learning_in_Two_stage_Recommender_Systems.html">
   Off-Policy Learning in Two-stage Recommender Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T471827_Adaptive_Estimator_Selection_for_Off_Policy_Evaluation.html">
   Adaptive Estimator Selection for Off-Policy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T902666_Evaluating_the_Robustness_of_Off_Policy_Evaluation.html">
   Evaluating the Robustness of Off-Policy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T705904_Evaluation_of_Multiple_Off_Policy_Estimators_on_Synthetic_Dataset.html">
   Evaluation of Multiple Off-Policy Estimators on Synthetic Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T874693_Evaluating_Standard_Off_Policy_Estimators_with_Small_Sample_Open_Bandit_Dataset.html">
   Evaluating Standard Off-Policy Estimators with Small Sample Open-Bandit Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T792262_Optimal_Off_Policy_Evaluation_from_Multiple_Logging_Policies.html">
   Optimal Off-Policy Evaluation from Multiple Logging Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T167249_Offline_Policy_Evaluation_with_VW_Command_Line.html">
   Offline Policy Evaluation with VW Command Line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T966055_OBP_Library_Workshop_Tutorials.html">
   OBP Library Workshop Tutorials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T632722_PyTorch_Fundamentals_Part_1.html">
   PyTorch Fundamentals Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T472467_PyTorch_Fundamentals_Part_2.html">
   PyTorch Fundamentals Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T206654_PyTorch_Fundamentals_Part_3.html">
   PyTorch Fundamentals Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T536348_Attention_Mechanisms.html">
   Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T500796_Agricultural_Satellite_Image_Segmentation.html">
   Agricultural Satellite Image Segmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T611432_Image_Analysis_with_Tensorflow.html">
   Image Analysis with Tensorflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T925716_MongoDB_to_CSV_Conversion.html">
   MongoDB to CSV conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T396469_PDF_to_Word_Cloud_via_Email.html">
   PDF to WordCloud via Email
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T030890_Job_Scraping_and_Clustering.html">
   Job scraping and clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T897054_Scene_Text_Recognition.html">
   Scene Text Recognition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T034809_Large_scale_Document_Retrieval_with_Elastic_Search.html">
   Large-scale Document Retrieval with ElasticSearch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T467251_vowpal_wabbit_contextual_recommender.html">
   Simulating a news personalization scenario using Contextual Bandits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T686684_similar_product_recommender.html">
   Similar Product Recommender system using Deep Learning for an online e-commerce store
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T132203_Retail_Product_Recommendations_using_Word2vec.html">
   Retail Product Recommendations using word2vec
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Retail Product Recommendation with Negative Implicit Feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T315965_Sequence_Aware_Recommenders_Music.html">
   Sequence Aware Recommender Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T051777_image_similarity_recommendations.html">
   Similar Product Recommendations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990172_recobook_diversity_aware_book_recommender.html">
   Diversity Aware Book Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T488549_Goodreads_Diversity_Aware_Book_Recommender.html">
   Diversity Aware Book Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T023535_Kafka_MongoDB_Real_time_Streaming.html">
   Kafka MongoDB Real-time Streaming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T622304_Session_based_Recommender_Using_Word2vec.html">
   Session-based recommendation using word2vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T416854_bandit_based_recommender_using_thompson_sampling_app.html">
   Bandit-based Online Learning using Thompson Sampling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T198578_Booking_dot_com_Trip_Recommendation.html">
   Booking.com Trip Recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T519734_Vowpal_Wabbit_Contextual_Bandit.html">
   Vowpal Wabbit Contextual Bandit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T871537_Recommendation_Systems_using_Olist_Dataset.html">
   Recommendation systems using Olist dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T057885_Offline_Replayer_Evaluation.html">
   Offline Replayer Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T915054_method_for_effective_online_testing.html">
   Methods for effective online testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T513987_Recsys_2020_Feature_Engineering_Tutorial.html">
   Recsys’20 Feature Engineering Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T227901_amazon_personalize_batch_job.html">
   Amazon Personalize Batch Job
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T022961_Amazon_Personalize_Workshop.html">
   Amazon Personalize Workshop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T424437_Collaborative_Filtering_on_ML_latest_small.html">
   Collaborative Filtering on ML-latest-small
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T539160_Building_and_Deploying_ASOS_Fashion_Recommender.html">
   Building and deploying ASOS fashion recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T757697_Simple_Similarity_based_Recommender.html">
   Simple Similarity based Recommmendations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T051594_Analytics_Zoo.html">
   Analytics Zoo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T313645_A_B_Testing.html">
   A/B Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T475711_PinSage_Graph_based_Recommender.html">
   PinSage Graph-based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T516490_Graph_Embeddings.html">
   Learn Embeddings using Graph Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T822164_movielens_milvus_redis_efficient_retrieval.html">
   Recommender with Redis and Milvus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T845186_Anime_Recommender.html">
   RekoNet Anime Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T855843_kafka_spark_streaming_colab.html">
   Kafka and Spark Streaming in Colab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T460437_Building_Models_From_Scratch.html">
   Building Models from scratch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T855971_Conet_Model_for_Movie_Recommender.html">
   CoNet model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T996996_content_based_and_collaborative_movielens.html">
   Movie Recommendation with Content-Based and Collaborative Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T239418_Simple_Movie_Recommenders.html">
   Simple Movie Recommenders
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T138337_Simple_Movie_Recommender.html">
   Simple movie recommender in implicit, explicit, and cold-start settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T935440_The_importance_of_Rating_Normalization.html">
   The importance of Rating Normalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T612622_cornac_examples.html">
   Cornac Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T561435_Flower_Classification.html">
   Flower classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T680910_Trivago_Session_based_Recommender.html">
   Trivago Session-based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_ads_selection_using_bandits.html">
   Best Ads detection using bandit methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_book_crossing_surprise_svd_nmf.html">
   Book-Crossing Recommendation System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_book_recommender_kubeflow.html">
   Books recommendations with Kubeflow Pipelines on Scaleway Kapsule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_build_a_kubeflow_pipeline.html">
   Build a Kubeflow Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_causal_inference.html">
   Causal Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_embedding_nlp.html">
   Exploring Word Embeddings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_neural_net.html">
   Neural Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_nlp_basics.html">
   Natural Language Processing 101
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_transformer_lm.html">
   TransformerLM Quick Start and Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_content_based_music_recommender_lyricsfreak.html">
   Content-based method for song recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_evaluation_metrics_basics.html">
   Recommender System Evaluations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_implicit_synthetic.html">
   Comparing Implicit Models on Synthetic Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movie_recommender_tensorflow.html">
   Recommendation Systems with TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movie_recommender_tensorflow_sagemaker.html">
   Movie recommender using Tensorflow in Sagemaker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movielens_eda_modeling.html">
   Movielens EDA and Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_read_data_from_cassandra_into_pandas.html">
   Read Cassandra Data Snapshot as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_rl_in_action.html">
   Reinforcement Learning fundamentals in action
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_rnn_cnn_basics.html">
   Processing sequences using RNNs and CNNs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_tf_serving_in_action.html">
   TF Serving in action
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_training_indexing_movie_recommender.html">
   Training and indexing movie recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T207114_EduRec_MOOCCube_Course_Recommender.html">
   EduRec MOOCCube Course Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T273184_Multi_Task_Learning.html">
   Multi-task Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T661108_Book_Recommender_API.html">
   Book Recommender API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T912764_Simple_Movie_Recommender_App.html">
   Simple Movie Recommender App
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T964554_Career_Village_Questions_Recommendation.html">
   CareerVillage Questions Recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_amazon_women_apparel_tfidf_word2vec.html">
   Amazon Product Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_anime_recommender_graph_network.html">
   Anime Recommender with Bi-partite Graph Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_concept_self_attention.html">
   Self-Attention
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_course_recommender_svd_flask.html">
   Course Recommender with SVD based similarity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_data_mining_similarity_measures.html">
   Concept - Data Mining Similarity Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_jaccard_recommender.html">
   Jaccard Similarity based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_live_streamer_recommender.html">
   Live Streamer Recommender with Implicit feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_songs_embedding_skipgram_recommender.html">
   Song Embeddings - Skipgram Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_toy_example_car_recommender_knn.html">
   Toy example - Car Recommender using KNN method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_wikirecs_recommender.html">
   WikiRecs
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nbs/T501828_Recommender_Implicit_Negative_Feedback.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sparsh-ai/reco-book/main?urlpath=tree/nbs/T501828_Recommender_Implicit_Negative_Feedback.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Retail Product Recommendation with Negative Implicit Feedback
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-loading">
     Data Loading
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wrangling">
     Wrangling
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#removing-duplicates">
       Removing Duplicates
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#label-encoding">
       Label Encoding
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploration">
     Exploration
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#user-interactions">
       User Interactions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#add-to-cart-event-counts">
       Add-to-cart Event Counts
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#purchase-event-counts">
       Purchase Event Counts
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#item-interactions">
       Item Interactions
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rule-based-approaches">
     Rule-based Approaches
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-n-trending-products">
       Top-N Trending Products
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#top-n-least-viewed-items">
       Top-N Least Viewed Items
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-transformation">
   Data Transformation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-count">
     A. Count
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-weighted-count">
     B. Weighted Count
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-time-dependent-count">
     C. Time dependent Count
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-test-split">
   Train Test Split
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#experiments">
   Experiments
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#item-popularity-recomendation-model">
     Item Popularity Recomendation Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cornac-bpr-model">
     Cornac BPR Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sars-model">
     SARS Model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spotlight">
     Spotlight
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implicit-factorization-model">
       Implicit Factorization Model
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cnn-pooling-sequence-model">
       CNN Pooling Sequence Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fastai-collablearner">
     FastAI CollabLearner
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="retail-product-recommendation-with-negative-implicit-feedback">
<h1>Retail Product Recommendation with Negative Implicit Feedback<a class="headerlink" href="#retail-product-recommendation-with-negative-implicit-feedback" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>A tutorial to demonstrate the process of training and evaluating various recommender models on a online retail store data. Along with the positive feedbacks like view, add-to-cart, we also have a negative event ‘remove-from-cart’.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install git+https://github.com/maciejkula/spotlight.git@master#egg=spotlight
!git clone https://github.com/microsoft/recommenders.git
!pip install cornac
!pip install pandas==0.25.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span><span class="p">,</span> <span class="n">dok_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">ParameterGrid</span>

<span class="kn">from</span> <span class="nn">fastai.collab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.tabular</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.text</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">cornac</span>

<span class="kn">from</span> <span class="nn">spotlight.interactions</span> <span class="kn">import</span> <span class="n">Interactions</span>
<span class="kn">from</span> <span class="nn">spotlight.interactions</span> <span class="kn">import</span> <span class="n">SequenceInteractions</span>
<span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="kn">import</span> <span class="n">random_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="kn">import</span> <span class="n">user_based_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.factorization.implicit</span> <span class="kn">import</span> <span class="n">ImplicitFactorizationModel</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">mrr_score</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">precision_recall_score</span>

<span class="kn">from</span> <span class="nn">spotlight.interactions</span> <span class="kn">import</span> <span class="n">Interactions</span>
<span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="kn">import</span> <span class="n">random_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.cross_validation</span> <span class="kn">import</span> <span class="n">user_based_train_test_split</span>
<span class="kn">from</span> <span class="nn">spotlight.factorization.implicit</span> <span class="kn">import</span> <span class="n">ImplicitFactorizationModel</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">mrr_score</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">precision_recall_score</span>

<span class="kn">from</span> <span class="nn">spotlight.interactions</span> <span class="kn">import</span> <span class="n">SequenceInteractions</span>
<span class="kn">from</span> <span class="nn">spotlight.sequence.implicit</span> <span class="kn">import</span> <span class="n">ImplicitSequenceModel</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">sequence_mrr_score</span>
<span class="kn">from</span> <span class="nn">spotlight.evaluation</span> <span class="kn">import</span> <span class="n">sequence_precision_recall_score</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/content/recommenders/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">reco_utils.dataset.python_splitters</span> <span class="kn">import</span> <span class="n">python_chrono_split</span>
<span class="kn">from</span> <span class="nn">reco_utils.evaluation.python_evaluation</span> <span class="kn">import</span> <span class="n">map_at_k</span>
<span class="kn">from</span> <span class="nn">reco_utils.evaluation.python_evaluation</span> <span class="kn">import</span> <span class="n">precision_at_k</span>
<span class="kn">from</span> <span class="nn">reco_utils.evaluation.python_evaluation</span> <span class="kn">import</span> <span class="n">ndcg_at_k</span> 
<span class="kn">from</span> <span class="nn">reco_utils.evaluation.python_evaluation</span> <span class="kn">import</span> <span class="n">recall_at_k</span>
<span class="kn">from</span> <span class="nn">reco_utils.evaluation.python_evaluation</span> <span class="kn">import</span> <span class="n">get_top_k_items</span>
<span class="kn">from</span> <span class="nn">reco_utils.recommender.cornac.cornac_utils</span> <span class="kn">import</span> <span class="n">predict_ranking</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="data-loading">
<h2>Data Loading<a class="headerlink" href="#data-loading" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># loading data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rawdata.csv&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">,</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span><span class="s1">&#39;itemid&#39;</span><span class="p">,</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
                 <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;category&#39;</span><span class="p">},</span>
                 <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event</th>
      <th>userid</th>
      <th>itemid</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>view_item</td>
      <td>2763227</td>
      <td>11056</td>
      <td>2020-01-13 16:05:31.244000+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_to_cart</td>
      <td>2828666</td>
      <td>14441</td>
      <td>2020-01-13 22:36:38.680000+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>view_item</td>
      <td>0620225789</td>
      <td>14377</td>
      <td>2020-01-14 10:54:41.886000+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>view_item</td>
      <td>0620225789</td>
      <td>14377</td>
      <td>2020-01-14 10:54:47.692000+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>add_to_cart</td>
      <td>0620225789</td>
      <td>14377</td>
      <td>2020-01-14 10:54:48.479000+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 99998 entries, 0 to 99997
Data columns (total 4 columns):
event        99998 non-null category
userid       99998 non-null category
itemid       99998 non-null category
timestamp    99998 non-null datetime64[ns, UTC]
dtypes: category(3), datetime64[ns, UTC](1)
memory usage: 1.7 MB
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="wrangling">
<h2>Wrangling<a class="headerlink" href="#wrangling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="removing-duplicates">
<h3>Removing Duplicates<a class="headerlink" href="#removing-duplicates" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># dropping exact duplicates</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="label-encoding">
<h3>Label Encoding<a class="headerlink" href="#label-encoding" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># userid normalization</span>
<span class="n">userid_encoder</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">userid</span> <span class="o">=</span> <span class="n">userid_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="p">)</span>

<span class="c1"># itemid normalization</span>
<span class="n">itemid_encoder</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">itemid</span> <span class="o">=</span> <span class="n">itemid_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exploration">
<h2>Exploration<a class="headerlink" href="#exploration" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>userid</th>
      <td>99432.0</td>
      <td>4682.814677</td>
      <td>3011.178734</td>
      <td>0.0</td>
      <td>2507.0</td>
      <td>3687.0</td>
      <td>6866.0</td>
      <td>11476.0</td>
    </tr>
    <tr>
      <th>itemid</th>
      <td>99432.0</td>
      <td>1344.579964</td>
      <td>769.627122</td>
      <td>0.0</td>
      <td>643.0</td>
      <td>1356.0</td>
      <td>1997.0</td>
      <td>2633.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
      <th>first</th>
      <th>last</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>event</th>
      <td>99432</td>
      <td>5</td>
      <td>begin_checkout</td>
      <td>41459</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>timestamp</th>
      <td>99432</td>
      <td>61372</td>
      <td>2020-01-16 04:21:49.377000+00:00</td>
      <td>25</td>
      <td>2020-01-13 16:05:31.244000+00:00</td>
      <td>2020-03-10 13:02:21.376000+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timedelta(&#39;56 days 20:56:50.132000&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>begin_checkout      41459
view_item           35397
purchase             9969
add_to_cart          7745
remove_from_cart     4862
Name: event, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>begin_checkout      3.612355
view_item           3.084168
purchase            0.868607
add_to_cart         0.674828
remove_from_cart    0.423630
Name: event, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="section" id="user-interactions">
<h3>User Interactions<a class="headerlink" href="#user-interactions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># User events</span>
<span class="n">user_activity_count</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">userid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_activity_count</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;view_item&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> 
                                           <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> 
                                           <span class="s1">&#39;purchase&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;view_item&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">][</span><span class="s1">&#39;view_item&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">][</span><span class="s1">&#39;add_to_cart&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">][</span><span class="s1">&#39;begin_checkout&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">][</span><span class="s1">&#39;remove_from_cart&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;purchase&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">userid</span><span class="p">][</span><span class="s1">&#39;purchase&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">user_activity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_activity_count</span><span class="p">)</span>
<span class="n">user_activity</span> <span class="o">=</span> <span class="n">user_activity</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">user_activity</span><span class="p">[</span><span class="s1">&#39;activity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_activity</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">tempDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_activity</span><span class="o">.</span><span class="n">activity</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">tempDF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#Interactions&#39;</span><span class="p">,</span><span class="s1">&#39;#Users&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;#Interactions&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;#Users&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tempDF</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_20_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_20_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#hide</span>
<span class="n">df_activity</span> <span class="o">=</span> <span class="n">user_activity</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">event</span> <span class="o">=</span> <span class="n">df_activity</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df_activity</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_activity</span><span class="p">[</span><span class="n">event</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="n">event</span><span class="p">[</span><span class="mi">0</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_21_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_21_0.png" />
</div>
</div>
</div>
<div class="section" id="add-to-cart-event-counts">
<h3>Add-to-cart Event Counts<a class="headerlink" href="#add-to-cart-event-counts" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df_activity</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_activity</span><span class="p">[</span><span class="n">event</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="n">event</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_23_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_23_0.png" />
</div>
</div>
</div>
<div class="section" id="purchase-event-counts">
<h3>Purchase Event Counts<a class="headerlink" href="#purchase-event-counts" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">df_activity</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_activity</span><span class="p">[</span><span class="n">event</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="n">event</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_25_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_25_0.png" />
</div>
</div>
</div>
<div class="section" id="item-interactions">
<h3>Item Interactions<a class="headerlink" href="#item-interactions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># item events</span>
<span class="n">item_activity_count</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">itemid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item_activity_count</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;view_item&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> 
                                           <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                                           <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> 
                                           <span class="s1">&#39;purchase&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;view_item&#39;</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">][</span><span class="s1">&#39;view_item&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">][</span><span class="s1">&#39;add_to_cart&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">][</span><span class="s1">&#39;begin_checkout&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">][</span><span class="s1">&#39;remove_from_cart&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;purchase&#39;</span><span class="p">:</span>
        <span class="n">item_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">itemid</span><span class="p">][</span><span class="s1">&#39;purchase&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">item_activity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">item_activity_count</span><span class="p">)</span>
<span class="n">item_activity</span> <span class="o">=</span> <span class="n">item_activity</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">item_activity</span><span class="p">[</span><span class="s1">&#39;activity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item_activity</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">tempDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">item_activity</span><span class="o">.</span><span class="n">activity</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">tempDF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#Interactions&#39;</span><span class="p">,</span><span class="s1">&#39;#Items&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;#Interactions&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;#Items&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tempDF</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_27_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span><span class="mi">3</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">({</span><span class="s1">&#39;Count&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span><span class="p">})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T501828_Recommender_Implicit_Negative_Feedback_28_0.png" src="../_images/T501828_Recommender_Implicit_Negative_Feedback_28_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="rule-based-approaches">
<h2>Rule-based Approaches<a class="headerlink" href="#rule-based-approaches" title="Permalink to this headline">¶</a></h2>
<div class="section" id="top-n-trending-products">
<h3>Top-N Trending Products<a class="headerlink" href="#top-n-trending-products" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">top_trending</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">timeperiod</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
  <span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">timeperiod</span><span class="p">))</span>
  <span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">trending_items</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">event</span><span class="o">==</span><span class="s1">&#39;view_item&#39;</span><span class="p">)),:]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">trending_items</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_current_time</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="n">top_trending</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">user_current_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([2241, 972, 393, 1118, 126], dtype=&#39;int64&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="top-n-least-viewed-items">
<h3>Top-N Least Viewed Items<a class="headerlink" href="#top-n-least-viewed-items" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">least_n_items</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">temp1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">event</span><span class="o">==</span><span class="s1">&#39;view_item&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;itemid&#39;</span><span class="p">])[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
  <span class="n">temp2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
  <span class="n">item_ids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">temp1</span><span class="p">,</span><span class="n">temp2</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;itemid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;itemid&#39;</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">itemid_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">item_ids</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">least_n_items</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;15742&#39;, &#39;16052&#39;, &#39;16443&#39;, &#39;16074&#39;, &#39;16424&#39;, &#39;11574&#39;, &#39;11465&#39;, &#39;16033&#39;, &#39;11711&#39;, &#39;16013&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-transformation">
<h1>Data Transformation<a class="headerlink" href="#data-transformation" title="Permalink to this headline">¶</a></h1>
<p>Many times there are no explicit ratings or preferences given by users, that is, the interactions are usually implicit. This
information may reflect users’ preference towards the items in an implicit manner.</p>
<p>Option 1 - Simple Count: The most simple technique is to count times of interactions between user and item for
producing affinity scores.</p>
<p>Option 2 - Weighted Count: It is useful to consider the types of different interactions as weights in the count
aggregation. For example, assuming weights of the three differen types, “click”, “add”, and “purchase”, are 1, 2, and 3, respectively.</p>
<p>Option 3 - Time-dependent Count: In many scenarios, time dependency plays a critical role in preparing dataset for
building a collaborative filtering model that captures user interests drift over time. One of the common techniques for
achieving time dependent count is to add a time decay factor in the counting.</p>
<div class="section" id="a-count">
<h2>A. Count<a class="headerlink" href="#a-count" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_count</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="s1">&#39;affinity&#39;</span><span class="p">]</span>
<span class="n">data_count</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>affinity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>328</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1122</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1204</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1271</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1821</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-weighted-count">
<h2>B. Weighted Count<a class="headerlink" href="#b-weighted-count" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_w</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">event</span><span class="o">!=</span><span class="s1">&#39;remove_from_cart&#39;</span><span class="p">,:]</span>

<span class="n">affinity_weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;view_item&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
    <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> 
    <span class="s1">&#39;purchase&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>

<span class="n">data_w</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">affinity_weights</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="n">data_w</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event</th>
      <th>userid</th>
      <th>itemid</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>view_item</td>
      <td>3141</td>
      <td>236</td>
      <td>2020-01-13 16:05:31.244000+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_to_cart</td>
      <td>3421</td>
      <td>1001</td>
      <td>2020-01-13 22:36:38.680000+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>view_item</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:41.886000+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>view_item</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:47.692000+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>add_to_cart</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:48.479000+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_w</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_w</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">affinity_weights</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">data_wcount</span> <span class="o">=</span> <span class="n">data_w</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">])[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_wcount</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="s1">&#39;affinity&#39;</span><span class="p">]</span>
<span class="n">data_wcount</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>affinity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>328</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1122</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1204</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1271</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1821</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="c-time-dependent-count">
<h2>C. Time dependent Count<a class="headerlink" href="#c-time-dependent-count" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">t_ref</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="n">data_w</span><span class="p">[</span><span class="s1">&#39;timedecay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_w</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log2</span><span class="p">((</span><span class="n">t_ref</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">days</span> <span class="o">/</span> <span class="n">T</span><span class="p">)),</span> 
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">data_w</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event</th>
      <th>userid</th>
      <th>itemid</th>
      <th>timestamp</th>
      <th>weight</th>
      <th>timedecay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>view_item</td>
      <td>3141</td>
      <td>236</td>
      <td>2020-01-13 16:05:31.244000+00:00</td>
      <td>1</td>
      <td>0.019056</td>
    </tr>
    <tr>
      <th>1</th>
      <td>add_to_cart</td>
      <td>3421</td>
      <td>1001</td>
      <td>2020-01-13 22:36:38.680000+00:00</td>
      <td>3</td>
      <td>0.057167</td>
    </tr>
    <tr>
      <th>2</th>
      <td>view_item</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:41.886000+00:00</td>
      <td>1</td>
      <td>0.019056</td>
    </tr>
    <tr>
      <th>3</th>
      <td>view_item</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:47.692000+00:00</td>
      <td>1</td>
      <td>0.019056</td>
    </tr>
    <tr>
      <th>4</th>
      <td>add_to_cart</td>
      <td>550</td>
      <td>972</td>
      <td>2020-01-14 10:54:48.479000+00:00</td>
      <td>3</td>
      <td>0.057167</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_wt</span> <span class="o">=</span> <span class="n">data_w</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">])[</span><span class="s1">&#39;timedecay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data_wt</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="s1">&#39;affinity&#39;</span><span class="p">]</span>
<span class="n">data_wt</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>affinity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>328</td>
      <td>0.117590</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1122</td>
      <td>0.120232</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1204</td>
      <td>0.120232</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1271</td>
      <td>0.120232</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1821</td>
      <td>0.120232</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="train-test-split">
<h1>Train Test Split<a class="headerlink" href="#train-test-split" title="Permalink to this headline">¶</a></h1>
<p>Option 1 - Random Split: Random split simply takes in a data set and outputs the splits of the data, given the split
ratios</p>
<p>Option 2 - Chronological split: Chronogically splitting method takes in a dataset and splits it on timestamp</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data_w</span><span class="p">[[</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span><span class="s1">&#39;itemid&#39;</span><span class="p">,</span><span class="s1">&#39;timedecay&#39;</span><span class="p">,</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]]</span>

<span class="n">col</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;col_user&#39;</span><span class="p">:</span> <span class="s1">&#39;userid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_item&#39;</span><span class="p">:</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_rating&#39;</span><span class="p">:</span> <span class="s1">&#39;timedecay&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">col3</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;col_user&#39;</span><span class="p">:</span> <span class="s1">&#39;userid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_item&#39;</span><span class="p">:</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_timestamp&#39;</span><span class="p">:</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">python_chrono_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">min_rating</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                  <span class="n">filter_by</span><span class="o">=</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">col3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">userid</span><span class="o">==</span><span class="mi">7</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>timedecay</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16679</th>
      <td>7</td>
      <td>1464</td>
      <td>0.019174</td>
      <td>2020-01-16 06:42:31.341000+00:00</td>
    </tr>
    <tr>
      <th>16691</th>
      <td>7</td>
      <td>1464</td>
      <td>0.019174</td>
      <td>2020-01-16 06:43:29.482000+00:00</td>
    </tr>
    <tr>
      <th>16692</th>
      <td>7</td>
      <td>2109</td>
      <td>0.019174</td>
      <td>2020-01-16 06:43:42.262000+00:00</td>
    </tr>
    <tr>
      <th>16694</th>
      <td>7</td>
      <td>1464</td>
      <td>0.019174</td>
      <td>2020-01-16 06:43:57.961000+00:00</td>
    </tr>
    <tr>
      <th>16805</th>
      <td>7</td>
      <td>201</td>
      <td>0.019174</td>
      <td>2020-01-16 06:45:55.261000+00:00</td>
    </tr>
    <tr>
      <th>16890</th>
      <td>7</td>
      <td>2570</td>
      <td>0.019174</td>
      <td>2020-01-16 06:54:12.315000+00:00</td>
    </tr>
    <tr>
      <th>16999</th>
      <td>7</td>
      <td>2570</td>
      <td>0.019174</td>
      <td>2020-01-16 06:54:29.130000+00:00</td>
    </tr>
    <tr>
      <th>17000</th>
      <td>7</td>
      <td>2570</td>
      <td>0.057522</td>
      <td>2020-01-16 06:54:35.097000+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">userid</span><span class="o">==</span><span class="mi">7</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>timedecay</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17001</th>
      <td>7</td>
      <td>1464</td>
      <td>0.019174</td>
      <td>2020-01-16 06:54:41.415000+00:00</td>
    </tr>
    <tr>
      <th>17003</th>
      <td>7</td>
      <td>1464</td>
      <td>0.057522</td>
      <td>2020-01-16 06:54:44.195000+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="experiments">
<h1>Experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h1>
<div class="section" id="item-popularity-recomendation-model">
<h2>Item Popularity Recomendation Model<a class="headerlink" href="#item-popularity-recomendation-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Recommending the most popular items is intuitive and simple approach</span>
<span class="n">item_counts</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">item_counts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="n">item_counts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>itemid</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2564</td>
      <td>461</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1463</td>
      <td>302</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1710</td>
      <td>267</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1985</td>
      <td>243</td>
    </tr>
    <tr>
      <th>4</th>
      <td>886</td>
      <td>229</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_item_col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">]</span>

<span class="c1"># Cross join users and items</span>
<span class="n">test_users</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s1">&#39;userid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">user_item_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">test_users</span><span class="p">,</span> <span class="n">item_counts</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">]))</span>
<span class="n">users_items</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_item_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">user_item_col</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of user-item pairs:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_items</span><span class="p">))</span>

<span class="c1"># Remove seen items (items in the train set) as we will not recommend those again to the users</span>
<span class="kn">from</span> <span class="nn">reco_utils.dataset.pandas_df_utils</span> <span class="kn">import</span> <span class="n">filter_by</span>
<span class="n">users_items_remove_seen</span> <span class="o">=</span> <span class="n">filter_by</span><span class="p">(</span><span class="n">users_items</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">user_item_col</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After remove seen items:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">users_items_remove_seen</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of user-item pairs: 4124250
After remove seen items: 4107466
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate recommendations</span>
<span class="n">baseline_recommendations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">item_counts</span><span class="p">,</span> <span class="n">users_items_remove_seen</span><span class="p">,</span> 
                                    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">baseline_recommendations</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>itemid</th>
      <th>count</th>
      <th>userid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2564</td>
      <td>461</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2564</td>
      <td>461</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2564</td>
      <td>461</td>
      <td>73</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2564</td>
      <td>461</td>
      <td>75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2564</td>
      <td>461</td>
      <td>113</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;col_user&#39;</span><span class="p">:</span> <span class="s1">&#39;userid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_item&#39;</span><span class="p">:</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_rating&#39;</span><span class="p">:</span> <span class="s1">&#39;timedecay&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_prediction&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">eval_map</span> <span class="o">=</span> <span class="n">map_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">baseline_recommendations</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_ndcg</span> <span class="o">=</span> <span class="n">ndcg_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">baseline_recommendations</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_precision</span> <span class="o">=</span> <span class="n">precision_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">baseline_recommendations</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">baseline_recommendations</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAP:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_map</span><span class="p">,</span>
      <span class="s2">&quot;NDCG@K:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_ndcg</span><span class="p">,</span>
      <span class="s2">&quot;Precision@K:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_precision</span><span class="p">,</span>
      <span class="s2">&quot;Recall@K:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_recall</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAP:	0.005334
NDCG@K:	0.010356
Precision@K:	0.007092
Recall@K:	0.011395
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cornac-bpr-model">
<h2>Cornac BPR Model<a class="headerlink" href="#cornac-bpr-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TOP_K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">NUM_FACTORS</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">NUM_EPOCHS</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">SEED</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_uir</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">)</span>

<span class="n">bpr</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">BPR</span><span class="p">(</span>
    <span class="n">k</span><span class="o">=</span><span class="n">NUM_FACTORS</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="n">NUM_EPOCHS</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">reco_utils.common.timer</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="k">with</span> <span class="n">Timer</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
    <span class="n">bpr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Took </span><span class="si">{}</span><span class="s2"> seconds for training.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Timer</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
    <span class="n">all_predictions</span> <span class="o">=</span> <span class="n">predict_ranking</span><span class="p">(</span><span class="n">bpr</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">usercol</span><span class="o">=</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> <span class="n">itemcol</span><span class="o">=</span><span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="n">remove_seen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Took </span><span class="si">{}</span><span class="s2"> seconds for prediction.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Took 4.7581 seconds for prediction.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_predictions</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userid</th>
      <th>itemid</th>
      <th>prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>51214</th>
      <td>7</td>
      <td>2551</td>
      <td>-0.438445</td>
    </tr>
    <tr>
      <th>51215</th>
      <td>7</td>
      <td>481</td>
      <td>2.522187</td>
    </tr>
    <tr>
      <th>51216</th>
      <td>7</td>
      <td>1185</td>
      <td>2.406107</td>
    </tr>
    <tr>
      <th>51217</th>
      <td>7</td>
      <td>1766</td>
      <td>1.112975</td>
    </tr>
    <tr>
      <th>51218</th>
      <td>7</td>
      <td>1359</td>
      <td>2.083620</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;col_user&#39;</span><span class="p">:</span> <span class="s1">&#39;userid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_item&#39;</span><span class="p">:</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_rating&#39;</span><span class="p">:</span> <span class="s1">&#39;timedecay&#39;</span><span class="p">,</span>
  <span class="s1">&#39;col_prediction&#39;</span><span class="p">:</span> <span class="s1">&#39;prediction&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">eval_map</span> <span class="o">=</span> <span class="n">map_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">all_predictions</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_ndcg</span> <span class="o">=</span> <span class="n">ndcg_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">all_predictions</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_precision</span> <span class="o">=</span> <span class="n">precision_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">all_predictions</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
<span class="n">eval_recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">all_predictions</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAP:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_map</span><span class="p">,</span>
      <span class="s2">&quot;NDCG:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_ndcg</span><span class="p">,</span>
      <span class="s2">&quot;Precision@K:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_precision</span><span class="p">,</span>
      <span class="s2">&quot;Recall@K:</span><span class="se">\t</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">eval_recall</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAP:	0.004738
NDCG:	0.009597
Precision@K:	0.006601
Recall@K:	0.010597
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sars-model">
<h2>SARS Model<a class="headerlink" href="#sars-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reco_utils.recommender.sar.sar_singlenode</span> <span class="kn">import</span> <span class="n">SARSingleNode</span>

<span class="n">TOP_K</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;col_user&quot;</span><span class="p">:</span> <span class="s2">&quot;userid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_item&quot;</span><span class="p">:</span> <span class="s2">&quot;itemid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_rating&quot;</span><span class="p">:</span> <span class="s2">&quot;timedecay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;col_prediction&quot;</span><span class="p">:</span> <span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SARSingleNode</span><span class="p">(</span>
    <span class="n">similarity_type</span><span class="o">=</span><span class="s2">&quot;jaccard&quot;</span><span class="p">,</span> 
    <span class="n">time_decay_coefficient</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
    <span class="n">time_now</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
    <span class="n">timedecay_formula</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="o">**</span><span class="n">header</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">top_k</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">recommend_k_items</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">remove_seen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># all ranking metrics have the same arguments</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">test</span><span class="p">,</span> <span class="n">top_k</span><span class="p">]</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">col_user</span><span class="o">=</span><span class="s1">&#39;userid&#39;</span><span class="p">,</span> 
              <span class="n">col_item</span><span class="o">=</span><span class="s1">&#39;itemid&#39;</span><span class="p">,</span> 
              <span class="n">col_rating</span><span class="o">=</span><span class="s1">&#39;timedecay&#39;</span><span class="p">,</span> 
              <span class="n">col_prediction</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> 
              <span class="n">relevancy_method</span><span class="o">=</span><span class="s1">&#39;top_k&#39;</span><span class="p">,</span> 
              <span class="n">k</span><span class="o">=</span><span class="n">TOP_K</span><span class="p">)</span>

<span class="n">eval_map</span> <span class="o">=</span> <span class="n">map_at_k</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">eval_ndcg</span> <span class="o">=</span> <span class="n">ndcg_at_k</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">eval_precision</span> <span class="o">=</span> <span class="n">precision_at_k</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">eval_recall</span> <span class="o">=</span> <span class="n">recall_at_k</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model:&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Top K:</span><span class="se">\t\t</span><span class="s2"> </span><span class="si">{</span><span class="n">TOP_K</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;MAP:</span><span class="se">\t\t</span><span class="s2"> </span><span class="si">{</span><span class="n">eval_map</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;NDCG:</span><span class="se">\t\t</span><span class="s2"> </span><span class="si">{</span><span class="n">eval_ndcg</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Precision@K:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">eval_precision</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Recall@K:</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">eval_recall</span><span class="si">:</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model:
Top K:		 10
MAP:		 0.024426
NDCG:		 0.032738
Precision@K:	 0.019258
Recall@K:	 0.036009
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="spotlight">
<h2>Spotlight<a class="headerlink" href="#spotlight" title="Permalink to this headline">¶</a></h2>
<div class="section" id="implicit-factorization-model">
<h3>Implicit Factorization Model<a class="headerlink" href="#implicit-factorization-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="n">Interactions</span><span class="p">(</span><span class="n">user_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">item_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">timestamps</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">),</span>
                            <span class="n">num_users</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span>
                            <span class="n">num_items</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="n">train_user</span><span class="p">,</span> <span class="n">test_user</span> <span class="o">=</span> <span class="n">random_train_test_split</span><span class="p">(</span><span class="n">interactions</span><span class="p">,</span> <span class="n">test_percentage</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImplicitFactorizationModel</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;bpr&#39;</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                   <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> 
                                   <span class="n">optimizer_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                   <span class="n">representation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                   <span class="n">num_negative_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_user</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pr</span> <span class="o">=</span> <span class="n">precision_recall_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test_user</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">train_user</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pricison@10 is </span><span class="si">{:.3f}</span><span class="s1"> and Recall@10 is </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 0: loss 0.26659833122392174
Epoch 1: loss 0.06129162273462562
Epoch 2: loss 0.022607273167640066
Epoch 3: loss 0.013953083943443858
Epoch 4: loss 0.01050195922488137
Epoch 5: loss 0.009170394043447121
Epoch 6: loss 0.008144461540834697
Epoch 7: loss 0.007209992620171649
Epoch 8: loss 0.00663076309035038
Epoch 9: loss 0.006706491189820159
Pricison@10 is 0.007 and Recall@10 is 0.050
</pre></div>
</div>
</div>
</div>
<p>Implicit Factorization Model with Grid Search</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="n">Interactions</span><span class="p">(</span><span class="n">user_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">item_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">timestamps</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">),</span>
                            <span class="n">num_users</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span>
                            <span class="n">num_items</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>

<span class="n">train_user</span><span class="p">,</span> <span class="n">test_user</span> <span class="o">=</span> <span class="n">random_train_test_split</span><span class="p">(</span><span class="n">interactions</span><span class="p">,</span> <span class="n">test_percentage</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">params_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:[</span><span class="s1">&#39;bpr&#39;</span><span class="p">,</span> <span class="s1">&#39;hinge&#39;</span><span class="p">],</span>
               <span class="s1">&#39;embedding_dim&#39;</span><span class="p">:[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
               <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
               <span class="s1">&#39;num_negative_samples&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
               <span class="p">}</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">ParameterGrid</span><span class="p">(</span><span class="n">params_grid</span><span class="p">)</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">:</span>
  <span class="n">model</span> <span class="o">=</span> <span class="n">ImplicitFactorizationModel</span><span class="p">(</span><span class="o">**</span><span class="n">p</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> 
                                    <span class="n">optimizer_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                    <span class="n">representation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_user</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">pr</span> <span class="o">=</span> <span class="n">precision_recall_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">test_user</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">train_user</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pricison@10 is </span><span class="si">{:.3f}</span><span class="s1"> and Recall@10 is </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/pandas/core/series.py:1139: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#deprecate-loc-reindex-listlike
  return self.loc[key]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 0: loss 0.29605319564173843
Epoch 1: loss 0.09024034632172231
Epoch 2: loss 0.04134876810469428
Epoch 3: loss 0.025742946812505697
Epoch 4: loss 0.019680531030682506
Epoch 5: loss 0.016188400935297803
Epoch 6: loss 0.013594527123945127
Epoch 7: loss 0.012133106459800596
Epoch 8: loss 0.011063214711144184
Epoch 9: loss 0.010611439098295579
Pricison@10 is 0.007 and Recall@10 is 0.047
Epoch 0: loss 0.29609743690184076
Epoch 1: loss 0.09252797421726766
Epoch 2: loss 0.04244603450826318
Epoch 3: loss 0.02713844289709709
Epoch 4: loss 0.01969600333667501
Epoch 5: loss 0.01603335079847808
Epoch 6: loss 0.014221997893418386
Epoch 7: loss 0.012988711276070673
Epoch 8: loss 0.011557109632238842
Epoch 9: loss 0.011109750410182539
Pricison@10 is 0.007 and Recall@10 is 0.050
Epoch 0: loss 0.2952524096827798
Epoch 1: loss 0.09147290865085132
Epoch 2: loss 0.0416853272766354
Epoch 3: loss 0.02605784918897309
Epoch 4: loss 0.019775863711413752
Epoch 5: loss 0.01594500694202313
Epoch 6: loss 0.014232497929574449
Epoch 7: loss 0.01294337215285353
Epoch 8: loss 0.011998023290540484
Epoch 9: loss 0.010945739889355717
Pricison@10 is 0.006 and Recall@10 is 0.045
Epoch 0: loss 0.46221058612084465
Epoch 1: loss 0.13077438028583188
Epoch 2: loss 0.07061944603680415
Epoch 3: loss 0.053692078858709795
Epoch 4: loss 0.045329024862510024
Epoch 5: loss 0.041573114408677225
Epoch 6: loss 0.0387881482244616
Epoch 7: loss 0.036440602202759007
Epoch 8: loss 0.035787560947095655
Epoch 9: loss 0.03322120658586167
Pricison@10 is 0.006 and Recall@10 is 0.041
Epoch 0: loss 0.4623263587522353
Epoch 1: loss 0.1317922399166696
Epoch 2: loss 0.07110214101635758
Epoch 3: loss 0.055422348614147236
Epoch 4: loss 0.0476353759083813
Epoch 5: loss 0.04135727373302175
Epoch 6: loss 0.04034828715972674
Epoch 7: loss 0.037419761230097034
Epoch 8: loss 0.03681224007818285
Epoch 9: loss 0.03620119842961191
Pricison@10 is 0.005 and Recall@10 is 0.039
Epoch 0: loss 0.46284369990181695
Epoch 1: loss 0.1312407074777643
Epoch 2: loss 0.070646146030863
Epoch 3: loss 0.05477426459240185
Epoch 4: loss 0.04863271401697991
Epoch 5: loss 0.041741091150107684
Epoch 6: loss 0.03963903292947692
Epoch 7: loss 0.036970180826159826
Epoch 8: loss 0.035346197669612923
Epoch 9: loss 0.03657649763952641
Pricison@10 is 0.006 and Recall@10 is 0.041
Epoch 0: loss 0.1972397086704659
Epoch 1: loss 0.06829694751949555
Epoch 2: loss 0.05330947832087612
Epoch 3: loss 0.04971556666148437
Epoch 4: loss 0.046018893009956055
Epoch 5: loss 0.045985528797965344
Epoch 6: loss 0.044439963151931376
Epoch 7: loss 0.04240149582385825
Epoch 8: loss 0.04087006046445711
Epoch 9: loss 0.04057819234848118
Pricison@10 is 0.004 and Recall@10 is 0.025
Epoch 0: loss 0.19465743656902068
Epoch 1: loss 0.0670443969775722
Epoch 2: loss 0.05303467901788916
Epoch 3: loss 0.04968067335258343
Epoch 4: loss 0.046125373380839635
Epoch 5: loss 0.04318332981461977
Epoch 6: loss 0.042641045980850216
Epoch 7: loss 0.04208077507698459
Epoch 8: loss 0.041522538493060986
Epoch 9: loss 0.040731122471703594
Pricison@10 is 0.004 and Recall@10 is 0.029
Epoch 0: loss 0.19681165678803944
Epoch 1: loss 0.0664056163892102
Epoch 2: loss 0.0535869363072505
Epoch 3: loss 0.04857526848338233
Epoch 4: loss 0.048490358762131626
Epoch 5: loss 0.044566346811567854
Epoch 6: loss 0.04327488357015553
Epoch 7: loss 0.042236022570341154
Epoch 8: loss 0.04146730487453497
Epoch 9: loss 0.040008874127934795
Pricison@10 is 0.004 and Recall@10 is 0.026
Epoch 0: loss 0.5279965880791091
Epoch 1: loss 0.452307569587729
Epoch 2: loss 0.4294101142614984
Epoch 3: loss 0.42500076900532774
Epoch 4: loss 0.4363042430239475
Epoch 5: loss 0.4657211991032987
Epoch 6: loss 0.42073505898859725
Epoch 7: loss 0.42356977115873357
Epoch 8: loss 0.45585063269954784
Epoch 9: loss 0.43355618334611895
Pricison@10 is 0.004 and Recall@10 is 0.027
Epoch 0: loss 0.5260213470727301
Epoch 1: loss 0.45165729455625897
Epoch 2: loss 0.4297575738843998
Epoch 3: loss 0.42066948568610135
Epoch 4: loss 0.4312238985031747
Epoch 5: loss 0.42702193119805726
Epoch 6: loss 0.444290085740603
Epoch 7: loss 0.43324954985039027
Epoch 8: loss 0.4306122352312232
Epoch 9: loss 0.4415178039856854
Pricison@10 is 0.005 and Recall@10 is 0.031
Epoch 0: loss 0.5295544630844876
Epoch 1: loss 0.4380661493041508
Epoch 2: loss 0.42663705986220735
Epoch 3: loss 0.44285977188605585
Epoch 4: loss 0.4236099698440055
Epoch 5: loss 0.44194267405095206
Epoch 6: loss 0.424336733338438
Epoch 7: loss 0.4380265812590191
Epoch 8: loss 0.434472453364222
Epoch 9: loss 0.43545967928610047
Pricison@10 is 0.004 and Recall@10 is 0.030
Epoch 0: loss 0.2234289297816071
Epoch 1: loss 0.1279702181074397
Epoch 2: loss 0.11148615261701525
Epoch 3: loss 0.10850249113473096
Epoch 4: loss 0.10298196010746756
Epoch 5: loss 0.09748751210150611
Epoch 6: loss 0.0969734352645
Epoch 7: loss 0.0931075753170961
Epoch 8: loss 0.0915131751699463
Epoch 9: loss 0.0897374461102524
Pricison@10 is 0.003 and Recall@10 is 0.018
Epoch 0: loss 0.2253206785756292
Epoch 1: loss 0.13100997741870174
Epoch 2: loss 0.11400738520206362
Epoch 3: loss 0.10849933280726337
Epoch 4: loss 0.10491025197496368
Epoch 5: loss 0.10026714504004675
Epoch 6: loss 0.09795559029966305
Epoch 7: loss 0.0932772220426817
Epoch 8: loss 0.09295417268991087
Epoch 9: loss 0.09168372073261684
Pricison@10 is 0.004 and Recall@10 is 0.027
Epoch 0: loss 0.22577087595531795
Epoch 1: loss 0.12992173730368783
Epoch 2: loss 0.11640790809197442
Epoch 3: loss 0.10946303474270645
Epoch 4: loss 0.10366896155419074
Epoch 5: loss 0.10071416692718432
Epoch 6: loss 0.09589668794556062
Epoch 7: loss 0.09583283946445134
Epoch 8: loss 0.09371932657058216
Epoch 9: loss 0.09230355569835261
Pricison@10 is 0.003 and Recall@10 is 0.024
Epoch 0: loss 1.2916136291057734
Epoch 1: loss 1.7776802640252558
Epoch 2: loss 1.7409840778139243
Epoch 3: loss 1.687181089085398
Epoch 4: loss 1.7308643511062267
Epoch 5: loss 1.6736974808180831
Epoch 6: loss 1.651738966392934
Epoch 7: loss 1.7159456276241989
Epoch 8: loss 1.6285421782655347
Epoch 9: loss 1.763627714761967
Pricison@10 is 0.004 and Recall@10 is 0.026
Epoch 0: loss 1.294814380993797
Epoch 1: loss 1.7931470209762599
Epoch 2: loss 1.7688716473686734
Epoch 3: loss 1.755566406767468
Epoch 4: loss 1.6464107822375282
Epoch 5: loss 1.703617206340434
Epoch 6: loss 1.6874780139355798
Epoch 7: loss 1.6423051294981474
Epoch 8: loss 1.628277428663812
Epoch 9: loss 1.6777792075630935
Pricison@10 is 0.004 and Recall@10 is 0.025
Epoch 0: loss 1.3243095058336902
Epoch 1: loss 1.7953596373846292
Epoch 2: loss 1.72956018528371
Epoch 3: loss 1.743988018614686
Epoch 4: loss 1.6520857222593865
Epoch 5: loss 1.6576296872073049
Epoch 6: loss 1.6600280645575938
Epoch 7: loss 1.6721530433061422
Epoch 8: loss 1.7022247500358287
Epoch 9: loss 1.6738990024930027
Pricison@10 is 0.004 and Recall@10 is 0.029
Epoch 0: loss 0.26678223316213323
Epoch 1: loss 0.0612365399933513
Epoch 2: loss 0.022778521771048617
Epoch 3: loss 0.013828953936204938
Epoch 4: loss 0.010637697962882338
Epoch 5: loss 0.00934013093064069
Epoch 6: loss 0.007684989493951153
Epoch 7: loss 0.007701974666836129
Epoch 8: loss 0.006867655064054193
Epoch 9: loss 0.00671699859270784
Pricison@10 is 0.008 and Recall@10 is 0.051
Epoch 0: loss 0.267548588622613
Epoch 1: loss 0.06067183332883085
Epoch 2: loss 0.02281374950560822
Epoch 3: loss 0.013809392712351497
Epoch 4: loss 0.010587326816950963
Epoch 5: loss 0.008792504775292956
Epoch 6: loss 0.008009265757156865
Epoch 7: loss 0.0074565373499611235
Epoch 8: loss 0.007098590578192132
Epoch 9: loss 0.00681110867523735
Pricison@10 is 0.008 and Recall@10 is 0.053
Epoch 0: loss 0.26481677225260875
Epoch 1: loss 0.06162541927440374
Epoch 2: loss 0.022879681100775384
Epoch 3: loss 0.01433396209300858
Epoch 4: loss 0.010934004527920935
Epoch 5: loss 0.00929655465282428
Epoch 6: loss 0.008289361950549091
Epoch 7: loss 0.00740667303029891
Epoch 8: loss 0.006837165096948384
Epoch 9: loss 0.006828171610562699
Pricison@10 is 0.007 and Recall@10 is 0.053
Epoch 0: loss 0.424381799061582
Epoch 1: loss 0.08664971538534885
Epoch 2: loss 0.04589304513630376
Epoch 3: loss 0.038735897107337304
Epoch 4: loss 0.033811092456066054
Epoch 5: loss 0.03218233990677635
Epoch 6: loss 0.03144083229279882
Epoch 7: loss 0.030326535367523694
Epoch 8: loss 0.03039964140839036
Epoch 9: loss 0.0313607786476636
Pricison@10 is 0.006 and Recall@10 is 0.044
Epoch 0: loss 0.4254932851078426
Epoch 1: loss 0.08756166415055465
Epoch 2: loss 0.04538155602548762
Epoch 3: loss 0.03897529531126524
Epoch 4: loss 0.03492546319015252
Epoch 5: loss 0.03294036035512805
Epoch 6: loss 0.03329139371130053
Epoch 7: loss 0.03167530871969663
Epoch 8: loss 0.032296937689712195
Epoch 9: loss 0.032698962740881604
Pricison@10 is 0.006 and Recall@10 is 0.041
Epoch 0: loss 0.42160729819555376
Epoch 1: loss 0.08756704588938756
Epoch 2: loss 0.04579582711205581
Epoch 3: loss 0.04007043815861753
Epoch 4: loss 0.034128753362085755
Epoch 5: loss 0.03233827561382623
Epoch 6: loss 0.03263001367180246
Epoch 7: loss 0.03131351158415174
Epoch 8: loss 0.030942449880721964
Epoch 9: loss 0.030438972015676486
Pricison@10 is 0.006 and Recall@10 is 0.042
Epoch 0: loss 0.1919897337866366
Epoch 1: loss 0.062042856169714805
Epoch 2: loss 0.051357087131194364
Epoch 3: loss 0.04529016200824374
Epoch 4: loss 0.04487682666354049
Epoch 5: loss 0.04414309574428862
Epoch 6: loss 0.04504055042310926
Epoch 7: loss 0.04177342097116245
Epoch 8: loss 0.04100956085027223
Epoch 9: loss 0.03946466099506789
Pricison@10 is 0.004 and Recall@10 is 0.024
Epoch 0: loss 0.19505955873003344
Epoch 1: loss 0.06246872200148473
Epoch 2: loss 0.05016463761400563
Epoch 3: loss 0.04570818116882415
Epoch 4: loss 0.04542697983467502
Epoch 5: loss 0.04463409970535438
Epoch 6: loss 0.04135937661747074
Epoch 7: loss 0.04026785464747734
Epoch 8: loss 0.039887369514541804
Epoch 9: loss 0.03812464036442747
Pricison@10 is 0.004 and Recall@10 is 0.030
Epoch 0: loss 0.1928439362399831
Epoch 1: loss 0.061154625255770236
Epoch 2: loss 0.05057755473797536
Epoch 3: loss 0.04760763201251674
Epoch 4: loss 0.0465072814878256
Epoch 5: loss 0.0445218765060043
Epoch 6: loss 0.04306420925824972
Epoch 7: loss 0.04141842263639932
Epoch 8: loss 0.03885935280783479
Epoch 9: loss 0.03769551119632372
Pricison@10 is 0.005 and Recall@10 is 0.032
Epoch 0: loss 0.6255892824705007
Epoch 1: loss 0.5785694408119683
Epoch 2: loss 0.5343080787796682
Epoch 3: loss 0.5397515998392627
Epoch 4: loss 0.5448340573063617
Epoch 5: loss 0.5294443992029433
Epoch 6: loss 0.5306488025118972
Epoch 7: loss 0.4954649354915144
Epoch 8: loss 0.5235111305603931
Epoch 9: loss 0.5053859731583733
Pricison@10 is 0.004 and Recall@10 is 0.029
Epoch 0: loss 0.6326714631445538
Epoch 1: loss 0.573512017918553
Epoch 2: loss 0.5273089357127714
Epoch 3: loss 0.5472853745654274
Epoch 4: loss 0.5311281712923402
Epoch 5: loss 0.5377801821785725
Epoch 6: loss 0.5537312353970154
Epoch 7: loss 0.5367784741966479
Epoch 8: loss 0.47841025037253787
Epoch 9: loss 0.5312429334357429
Pricison@10 is 0.004 and Recall@10 is 0.029
Epoch 0: loss 0.6268260534553283
Epoch 1: loss 0.5624153050579058
Epoch 2: loss 0.5298431843183815
Epoch 3: loss 0.5396579839888109
Epoch 4: loss 0.5381371908105455
Epoch 5: loss 0.5168753017782207
Epoch 6: loss 0.48948019892696015
Epoch 7: loss 0.4905602858189218
Epoch 8: loss 0.5053348687396555
Epoch 9: loss 0.5373068574181132
Pricison@10 is 0.004 and Recall@10 is 0.029
Epoch 0: loss 0.23225398366474262
Epoch 1: loss 0.13146403681043645
Epoch 2: loss 0.11786584738174818
Epoch 3: loss 0.10868372224343167
Epoch 4: loss 0.10243410413479882
Epoch 5: loss 0.09941196136200543
Epoch 6: loss 0.09679907708880986
Epoch 7: loss 0.09597368322768011
Epoch 8: loss 0.09440059982647467
Epoch 9: loss 0.09285185775956158
Pricison@10 is 0.003 and Recall@10 is 0.023
Epoch 0: loss 0.23057798509429123
Epoch 1: loss 0.13307480200214786
Epoch 2: loss 0.11867008248038614
Epoch 3: loss 0.11186671285767263
Epoch 4: loss 0.10736680121858787
Epoch 5: loss 0.10359690031725494
Epoch 6: loss 0.10164711832808529
Epoch 7: loss 0.09720324220620934
Epoch 8: loss 0.09211324512287734
Epoch 9: loss 0.09142769774919154
Pricison@10 is 0.003 and Recall@10 is 0.018
Epoch 0: loss 0.23323329780071111
Epoch 1: loss 0.13417892158031464
Epoch 2: loss 0.11723061798326072
Epoch 3: loss 0.10971038677157696
Epoch 4: loss 0.1073669156125504
Epoch 5: loss 0.10198603978925579
Epoch 6: loss 0.10140255498445302
Epoch 7: loss 0.09986353406856298
Epoch 8: loss 0.09296791315366218
Epoch 9: loss 0.09289196610354918
Pricison@10 is 0.004 and Recall@10 is 0.026
Epoch 0: loss 1.8212750715074815
Epoch 1: loss 2.368166323068441
Epoch 2: loss 2.2547610501767736
Epoch 3: loss 2.0896969359978987
Epoch 4: loss 2.074246685221264
Epoch 5: loss 2.107905259206172
Epoch 6: loss 2.1261368730252195
Epoch 7: loss 2.0352458648168006
Epoch 8: loss 2.1936914333384903
Epoch 9: loss 2.0269214924412906
Pricison@10 is 0.004 and Recall@10 is 0.031
Epoch 0: loss 1.8324132722673692
Epoch 1: loss 2.4329963008307183
Epoch 2: loss 2.2162452385164917
Epoch 3: loss 2.092274981104676
Epoch 4: loss 2.1043862517432
Epoch 5: loss 2.0506169550671838
Epoch 6: loss 2.1609063529412462
Epoch 7: loss 2.1431561312683143
Epoch 8: loss 2.0215363380322504
Epoch 9: loss 1.9930379555180333
Pricison@10 is 0.004 and Recall@10 is 0.028
Epoch 0: loss 1.8448880979869144
Epoch 1: loss 2.378598579448136
Epoch 2: loss 2.296310121415129
Epoch 3: loss 2.131826051657606
Epoch 4: loss 2.101037339573888
Epoch 5: loss 2.0981224655530077
Epoch 6: loss 2.1441538588793714
Epoch 7: loss 2.014261698416192
Epoch 8: loss 1.9355182779228188
Epoch 9: loss 2.084795298492027
Pricison@10 is 0.004 and Recall@10 is 0.030
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cnn-pooling-sequence-model">
<h3>CNN Pooling Sequence Model<a class="headerlink" href="#cnn-pooling-sequence-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="n">Interactions</span><span class="p">(</span><span class="n">user_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">userid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">item_ids</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">timestamps</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">))</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">random_train_test_split</span><span class="p">(</span><span class="n">interactions</span><span class="p">,</span> <span class="n">test_percentage</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">train_seq</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">max_sequence_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test_seq</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">to_sequence</span><span class="p">(</span><span class="n">max_sequence_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImplicitSequenceModel</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;bpr&#39;</span><span class="p">,</span> <span class="n">representation</span><span class="o">=</span><span class="s1">&#39;pooling&#39;</span><span class="p">,</span> 
                              <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> 
                              <span class="n">l2</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">optimizer_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">use_cuda</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_negative_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_seq</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mrr_seq</span> <span class="o">=</span> <span class="n">sequence_mrr_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_seq</span><span class="p">)</span>
<span class="n">mrr_seq</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 0: loss 0.4226887328702895
Epoch 1: loss 0.23515070266410953
Epoch 2: loss 0.16919970976524665
Epoch 3: loss 0.1425025990751923
Epoch 4: loss 0.12612225017586692
Epoch 5: loss 0.11565039795441706
Epoch 6: loss 0.10787886735357222
Epoch 7: loss 0.10086931410383006
Epoch 8: loss 0.09461003749585542
Epoch 9: loss 0.09128284808553633
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.10435609591957387
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="fastai-collablearner">
<h2>FastAI CollabLearner<a class="headerlink" href="#fastai-collablearner" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;view_item&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                <span class="s1">&#39;add_to_cart&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                <span class="s1">&#39;begin_checkout&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
                                <span class="s1">&#39;purchase&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                               <span class="s1">&#39;remove_from_cart&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="p">})</span>

<span class="n">ratings</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;userid&quot;</span><span class="p">,</span> <span class="s1">&#39;itemid&#39;</span><span class="p">,</span> <span class="s2">&quot;rating&quot;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">CollabDataBunch</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TabularDataBunch;

Train: LabelList (79546 items)
x: CollabList
userid 3141; itemid 236; ,userid 3421; itemid 1001; ,userid 550; itemid 972; ,userid 550; itemid 972; ,userid 550; itemid 972; 
y: FloatList
1.0,2.0,1.0,1.0,2.0
Path: .;

Valid: LabelList (19886 items)
x: CollabList
userid 6785; itemid 183; ,userid 1458; itemid 1356; ,userid 3817; itemid 2368; ,userid 9777; itemid 2466; ,userid 11077; itemid 1359; 
y: FloatList
1.0,3.0,3.0,1.0,2.0
Path: .;

Test: None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">collab_learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_factors</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">skip_end</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<img src='https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F7986b4f6-99fa-4b8c-94c5-a218b16286b5%2FUntitled.png?table=block&id=f5a13f31-cb3d-462f-ab79-401d9179cb5f&spaceId=63b72b1f-0e90-4ab8-a6df-a060a6545a56&width=2000&userId=21ec183f-f0be-4b6b-9b3e-6f0d4e5c5469&cache=v2'><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.054070</td>
      <td>2.029182</td>
      <td>00:20</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EmbeddingDotBias
======================================================================
Layer (type)         Output Shape         Param #    Trainable 
======================================================================
Embedding            [50]                 534,000    True      
______________________________________________________________________
Embedding            [50]                 129,150    True      
______________________________________________________________________
Embedding            [1]                  10,680     True      
______________________________________________________________________
Embedding            [1]                  2,583      True      
______________________________________________________________________

Total params: 676,413
Total trainable params: 676,413
Total non-trainable params: 0
Optimized with &#39;torch.optim.adam.Adam&#39;, betas=(0.9, 0.99)
Using true weight decay as discussed in https://www.fast.ai/2018/07/02/adam-weight-decay/ 
Loss function : FlattenedLoss
======================================================================
Callbacks functions applied 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.770657</td>
      <td>1.751797</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.410351</td>
      <td>1.528533</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.153979</td>
      <td>1.399136</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.911953</td>
      <td>1.326476</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.784223</td>
      <td>1.279517</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.695546</td>
      <td>1.248469</td>
      <td>00:17</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.637151</td>
      <td>1.230954</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.600011</td>
      <td>1.216617</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.573309</td>
      <td>1.209507</td>
      <td>00:18</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.571132</td>
      <td>1.204903</td>
      <td>00:18</td>
    </tr>
  </tbody>
</table></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nbs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="T132203_Retail_Product_Recommendations_using_Word2vec.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Retail Product Recommendations using word2vec</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="T315965_Sequence_Aware_Recommenders_Music.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Sequence Aware Recommender Systems</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sparsh A.<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>