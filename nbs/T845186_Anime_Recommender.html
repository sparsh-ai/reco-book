
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RekoNet Anime Recommender &#8212; Reco Book</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kafka and Spark Streaming in Colab" href="T855843_kafka_spark_streaming_colab.html" />
    <link rel="prev" title="Recommender with Redis and Milvus" href="T822164_movielens_milvus_redis_efficient_retrieval.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Reco Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Tutorials in Jupyter notebook format
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  User Stories
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="US780867_Transformer_based_Recommenders.html">
   Transformer-based Recommenders
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="T034923_BERT4Rec_on_ML1M_in_PyTorch.html">
     BERT4Rec on ML-1M in PyTorch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T595874_BERT4Rec_on_ML25M_in_PyTorch_Lightning.html">
     BERT4Rec on ML-25M
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T088416_BST_Implementation_in_MXNet.html">
     BST Implementation in MXNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T602245_BST_implementation_in_PyTorch.html">
     BST implementation in PyTorch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T007665_BST_on_ML1M_in_Keras.html">
     A Transformer-based recommendation system
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T881207_BST_PTLightning_ML1M.html">
     Rating prediction using the Behavior Sequence Transformer (BST) model on ML-1M dataset in PyTorch Lightning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T025247_BST_using_Deepctr_library.html">
     BST using Deepctr library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T757997_SASRec_PyTorch.html">
     SASRec implementation with PyTorch Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T225287_SASRec_PaddlePaddle.html">
     SASRec implementation with Paddle Library
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T701627_SR_SAN_Session_based_Model.html">
     SR-SAN Session-based Recommender
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T975104_SSEPT_ML1M_Tensorflow1x.html">
     SSE-PT Personalized Transformer Recommender on ML-1M in Tensorflow 1.x
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T472955_GCSAN_Session_based_Model.html">
     GCSAN Session-based Recommender
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T970274_Transformers4Rec_Session_based_Recommender_on_Yoochoose.html">
     End-to-end session-based recommendation with Transformers4Rec
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T382183_Transformers4Rec_XLNet_on_Synthetic_data.html">
     Transformers4Rec XLNet on Synthetic data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="T793395_Session_based_recommendation_on_REES46_Dataset.html">
     End-to-end Session-based recommendation on REES46 Dataset
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Prototypes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="T382881_DeepWalk_Karateclub.html">
   DeepWalk from scratch referencing Karateclub library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T384270_DeepWalk_pure_python.html">
   DeepWalk in pure python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T677598_Jaccard_Cosine_SVD_DeepWalk_ML100K.html">
   Recommender System with DeepWalk Graph Embeddings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T815556_Node2vec_Karateclub.html">
   Node2vec from scratch referencing Karateclub library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T894941_Node2vec_MovieLens_Keras.html">
   Graph representation learning with node2vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T611050_Node2vec_PyG.html">
   Node2vec from scratch in PyTorch Geometric
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T186367_Node2vec_library.html">
   Node2vec from scratch referencing node2vec library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T331379_bayesian_personalized_ranking.html">
   BPR from scratch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T081831_Data_Poisoning_Attacks_on_Factorization_Based_Collaborative_Filtering.html">
   Data Poisoning Attacks on Factorization-Based Collaborative Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T102448_Adversarial_Learning_for_Recommendation.html">
   Adversarial Training (Regularization) on a Recommender System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T865035_Simulating_Data_Poisoning_Attacks_against_Twitter_Recommender.html">
   Load and process dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T711285_Data_Poisoning_Attack_using_LFM_and_ItemAE_on_Synthetic_Dataset.html">
   Injection attack using LFM and ItemAE model trained on Toy dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T355514_Black_box_Attack_on_Sequential_Recs.html">
   Black-box Attack on Sequential Recs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T873451_Statistics_fundamentals.html">
   Statictics Fundamentals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T890478_Batch_Learning_from_Bandit_Feedback_%28BLBF%29.html">
   Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T257798_Off_Policy_Learning_in_Two_stage_Recommender_Systems.html">
   Off-Policy Learning in Two-stage Recommender Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T471827_Adaptive_Estimator_Selection_for_Off_Policy_Evaluation.html">
   Adaptive Estimator Selection for Off-Policy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T902666_Evaluating_the_Robustness_of_Off_Policy_Evaluation.html">
   Evaluating the Robustness of Off-Policy Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T705904_Evaluation_of_Multiple_Off_Policy_Estimators_on_Synthetic_Dataset.html">
   Evaluation of Multiple Off-Policy Estimators on Synthetic Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T874693_Evaluating_Standard_Off_Policy_Estimators_with_Small_Sample_Open_Bandit_Dataset.html">
   Evaluating Standard Off-Policy Estimators with Small Sample Open-Bandit Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T792262_Optimal_Off_Policy_Evaluation_from_Multiple_Logging_Policies.html">
   Optimal Off-Policy Evaluation from Multiple Logging Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T167249_Offline_Policy_Evaluation_with_VW_Command_Line.html">
   Offline Policy Evaluation with VW Command Line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T966055_OBP_Library_Workshop_Tutorials.html">
   OBP Library Workshop Tutorials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T632722_PyTorch_Fundamentals_Part_1.html">
   PyTorch Fundamentals Part 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T472467_PyTorch_Fundamentals_Part_2.html">
   PyTorch Fundamentals Part 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T206654_PyTorch_Fundamentals_Part_3.html">
   PyTorch Fundamentals Part 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T536348_Attention_Mechanisms.html">
   Imports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T500796_Agricultural_Satellite_Image_Segmentation.html">
   Agricultural Satellite Image Segmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T611432_Image_Analysis_with_Tensorflow.html">
   Image Analysis with Tensorflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T925716_MongoDB_to_CSV_Conversion.html">
   MongoDB to CSV conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T396469_PDF_to_Word_Cloud_via_Email.html">
   PDF to WordCloud via Email
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T030890_Job_Scraping_and_Clustering.html">
   Job scraping and clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T897054_Scene_Text_Recognition.html">
   Scene Text Recognition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T034809_Large_scale_Document_Retrieval_with_Elastic_Search.html">
   Large-scale Document Retrieval with ElasticSearch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T467251_vowpal_wabbit_contextual_recommender.html">
   Simulating a news personalization scenario using Contextual Bandits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T686684_similar_product_recommender.html">
   Similar Product Recommender system using Deep Learning for an online e-commerce store
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T132203_Retail_Product_Recommendations_using_Word2vec.html">
   Retail Product Recommendations using word2vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T501828_Recommender_Implicit_Negative_Feedback.html">
   Retail Product Recommendation with Negative Implicit Feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T315965_Sequence_Aware_Recommenders_Music.html">
   Sequence Aware Recommender Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T051777_image_similarity_recommendations.html">
   Similar Product Recommendations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990172_recobook_diversity_aware_book_recommender.html">
   Diversity Aware Book Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T488549_Goodreads_Diversity_Aware_Book_Recommender.html">
   Diversity Aware Book Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T023535_Kafka_MongoDB_Real_time_Streaming.html">
   Kafka MongoDB Real-time Streaming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T622304_Session_based_Recommender_Using_Word2vec.html">
   Session-based recommendation using word2vec
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T416854_bandit_based_recommender_using_thompson_sampling_app.html">
   Bandit-based Online Learning using Thompson Sampling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T198578_Booking_dot_com_Trip_Recommendation.html">
   Booking.com Trip Recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T519734_Vowpal_Wabbit_Contextual_Bandit.html">
   Vowpal Wabbit Contextual Bandit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T871537_Recommendation_Systems_using_Olist_Dataset.html">
   Recommendation systems using Olist dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T057885_Offline_Replayer_Evaluation.html">
   Offline Replayer Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T915054_method_for_effective_online_testing.html">
   Methods for effective online testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T513987_Recsys_2020_Feature_Engineering_Tutorial.html">
   Recsys’20 Feature Engineering Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T227901_amazon_personalize_batch_job.html">
   Amazon Personalize Batch Job
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T022961_Amazon_Personalize_Workshop.html">
   Amazon Personalize Workshop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T424437_Collaborative_Filtering_on_ML_latest_small.html">
   Collaborative Filtering on ML-latest-small
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T539160_Building_and_Deploying_ASOS_Fashion_Recommender.html">
   Building and deploying ASOS fashion recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T757697_Simple_Similarity_based_Recommender.html">
   Simple Similarity based Recommmendations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T051594_Analytics_Zoo.html">
   Analytics Zoo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T313645_A_B_Testing.html">
   A/B Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T475711_PinSage_Graph_based_Recommender.html">
   PinSage Graph-based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T516490_Graph_Embeddings.html">
   Learn Embeddings using Graph Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T822164_movielens_milvus_redis_efficient_retrieval.html">
   Recommender with Redis and Milvus
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   RekoNet Anime Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T855843_kafka_spark_streaming_colab.html">
   Kafka and Spark Streaming in Colab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T460437_Building_Models_From_Scratch.html">
   Building Models from scratch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T855971_Conet_Model_for_Movie_Recommender.html">
   CoNet model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T996996_content_based_and_collaborative_movielens.html">
   Movie Recommendation with Content-Based and Collaborative Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T239418_Simple_Movie_Recommenders.html">
   Simple Movie Recommenders
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T138337_Simple_Movie_Recommender.html">
   Simple movie recommender in implicit, explicit, and cold-start settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T935440_The_importance_of_Rating_Normalization.html">
   The importance of Rating Normalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T612622_cornac_examples.html">
   Cornac Examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T561435_Flower_Classification.html">
   Flower classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T680910_Trivago_Session_based_Recommender.html">
   Trivago Session-based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_ads_selection_using_bandits.html">
   Best Ads detection using bandit methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_book_crossing_surprise_svd_nmf.html">
   Book-Crossing Recommendation System
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_book_recommender_kubeflow.html">
   Books recommendations with Kubeflow Pipelines on Scaleway Kapsule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_build_a_kubeflow_pipeline.html">
   Build a Kubeflow Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_causal_inference.html">
   Causal Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_embedding_nlp.html">
   Exploring Word Embeddings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_neural_net.html">
   Neural Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_nlp_basics.html">
   Natural Language Processing 101
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_concept_transformer_lm.html">
   TransformerLM Quick Start and Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_content_based_music_recommender_lyricsfreak.html">
   Content-based method for song recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_evaluation_metrics_basics.html">
   Recommender System Evaluations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_implicit_synthetic.html">
   Comparing Implicit Models on Synthetic Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movie_recommender_tensorflow.html">
   Recommendation Systems with TensorFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movie_recommender_tensorflow_sagemaker.html">
   Movie recommender using Tensorflow in Sagemaker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_movielens_eda_modeling.html">
   Movielens EDA and Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_read_data_from_cassandra_into_pandas.html">
   Read Cassandra Data Snapshot as DataFrame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_rl_in_action.html">
   Reinforcement Learning fundamentals in action
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_rnn_cnn_basics.html">
   Processing sequences using RNNs and CNNs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_tf_serving_in_action.html">
   TF Serving in action
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990000_training_indexing_movie_recommender.html">
   Training and indexing movie recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T207114_EduRec_MOOCCube_Course_Recommender.html">
   EduRec MOOCCube Course Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T273184_Multi_Task_Learning.html">
   Multi-task Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T661108_Book_Recommender_API.html">
   Book Recommender API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T912764_Simple_Movie_Recommender_App.html">
   Simple Movie Recommender App
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T964554_Career_Village_Questions_Recommendation.html">
   CareerVillage Questions Recommendation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_amazon_women_apparel_tfidf_word2vec.html">
   Amazon Product Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_anime_recommender_graph_network.html">
   Anime Recommender with Bi-partite Graph Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_concept_self_attention.html">
   Self-Attention
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_course_recommender_svd_flask.html">
   Course Recommender with SVD based similarity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_data_mining_similarity_measures.html">
   Concept - Data Mining Similarity Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_jaccard_recommender.html">
   Jaccard Similarity based Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_live_streamer_recommender.html">
   Live Streamer Recommender with Implicit feedback
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_songs_embedding_skipgram_recommender.html">
   Song Embeddings - Skipgram Recommender
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_toy_example_car_recommender_knn.html">
   Toy example - Car Recommender using KNN method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T990001_wikirecs_recommender.html">
   WikiRecs
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nbs/T845186_Anime_Recommender.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sparsh-ai/reco-book/main?urlpath=tree/nbs/T845186_Anime_Recommender.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background">
   Background
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-data-and-pre-trained-model">
   Download data and pre-trained model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#autoencoder-model">
   Autoencoder model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-cleaned-dataset">
   Load cleaned dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#japanese-to-english-translated-titles">
   Japanese to english translated titles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-time-process">
   Run time process
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hybrid-filter">
   Hybrid filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-time">
   Run time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="rekonet-anime-recommender">
<h1>RekoNet Anime Recommender<a class="headerlink" href="#rekonet-anime-recommender" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>The data crawled from the popular anime website <a class="reference external" href="http://myanimelist.net/">MyAnimeList.net</a>, and cleaned of duplicates as well as missing values and false data. Following that, autoencoders used to learn embeddings of all the anime titles present in the dataset, which were then used to cluster the same.</p>
</div></blockquote>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>deep autoencoders for predicting ratings and generating embeddings.</p></li>
<li><p>form clusters using embeddings of anime titles</p></li>
<li><p>find similar animes using similarity metric based on like and dislike of user</p></li>
<li><p>combine with rating prediction to create a hybrid recommender</p></li>
</ol>
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Anime (a term derived from the English word animation) is a form of hand-drawn computer animation which originated in Japan and has now developed a cult following around the world. In recent years, the Anime industry has been growing at an enormous pace making billions of dollars in profit every year. Its market has gained attention from major streaming platforms like Netflix and Amazon Prime. In the pre-internet era, Anime enthusiasts discovered new titles through word of mouth. Hence personalized recommendations were not required. Moreover, the number of titles released were quite less to facilitate a data-based approach for personalized recommendations. However, in recent years, with the boom of streaming services and the amount of newly released anime titles, people can watch Anime as much as they like. This calls for a personalized recommendation system for this new generation of Anime watchers.</p>
<img src='https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4af2b09a-fac4-4cce-8a49-e7d39581b463%2FUntitled.png?table=block&id=a7ce798e-251f-435a-a5f4-eeef2aa7e2e6&spaceId=63b72b1f-0e90-4ab8-a6df-a060a6545a56&width=2000&userId=21ec183f-f0be-4b6b-9b3e-6f0d4e5c5469&cache=v2'><p>The data used for training Rikonet was crawled from the popular anime website <a class="reference external" href="http://myanimelist.net/">MyAnimeList.net</a> using the Jikan API. The collected data was cleaned of duplicates as well as missing values and false data and reduced to 6668 anime titles while retaining all the key information.</p>
<p>Following that, autoencoders used to learn embeddings of all the anime titles present in the dataset, which were then used to cluster the same.</p>
<p>The logically opposite clusters of the anime titles are estimated as well.</p>
<p>At run-time, when a user requests a new recommendation list, the user’s context, i.e., the anime titles rated so far is fed into the primary autoencoder, which computes the predicted ratings for the unrated titles.</p>
<p>These ratings are further fed to a hybrid filter, which generates 2 lists, namely - Similar Anime and Anime You May Like, the former showing anime titles similar to the ones the user rated highly and the later showing titles which the user may like based on his overall ratings.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!pip install google_trans_new
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.nn.init</span> <span class="k">as</span> <span class="nn">init</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">transforms</span>

<span class="kn">from</span> <span class="nn">google_trans_new</span> <span class="kn">import</span> <span class="n">google_translator</span>  
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="download-data-and-pre-trained-model">
<h2>Download data and pre-trained model<a class="headerlink" href="#download-data-and-pre-trained-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!wget https://github.com/sparsh-ai/reco-data/raw/master/anime/anime_cleaned.csv
!wget https://github.com/sparsh-ai/reco-data/raw/master/anime/anime_genres.csv
!wget https://github.com/sparsh-ai/reco-data/raw/master/anime/clusters.csv
!wget https://github.com/sparsh-ai/reco-data/raw/master/anime/inputFormater.csv
!gdown --id 1LV7VHOTqU5WgBYxfRcUeY31dbhcBqyzb
!gdown --id 14x3TgzhFl-XCHjJHtX-mZrtTSkJgIIey
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">top_animes</span><span class="p">(</span><span class="n">genre</span><span class="p">,</span> <span class="n">ani_genre</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">):</span>
    <span class="n">top</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top&quot;</span><span class="p">,</span> <span class="n">genre</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ani_genre</span><span class="p">[</span><span class="n">ani_genre</span><span class="p">[</span><span class="n">genre</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;anime_id&#39;</span><span class="p">])</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_anime</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">temp</span><span class="p">))</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">][</span><span class="n">x</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">][</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;title_english&#39;</span><span class="p">][</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
             <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">][</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">][</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span>
        <span class="n">top</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;S.No.&#39;</span><span class="p">,</span> <span class="s1">&#39;Anime ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Title&#39;</span><span class="p">,</span> <span class="s1">&#39;English Title&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;Anime Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Anime Genre&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;clusters.csv&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>anime_id</th>
      <th>title</th>
      <th>alpha</th>
      <th>omega</th>
      <th>zeta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11013</td>
      <td>Inu x Boku SS</td>
      <td>15</td>
      <td>82</td>
      <td>135</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2104</td>
      <td>Seto no Hanayome</td>
      <td>125</td>
      <td>157</td>
      <td>55</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5262</td>
      <td>Shugo Chara!! Doki</td>
      <td>130</td>
      <td>113</td>
      <td>82</td>
    </tr>
    <tr>
      <th>3</th>
      <td>721</td>
      <td>Princess Tutu</td>
      <td>159</td>
      <td>108</td>
      <td>97</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12365</td>
      <td>Bakuman. 3rd Season</td>
      <td>112</td>
      <td>55</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">222</span><span class="p">):</span>
    <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)):</span>
    <span class="n">clusters</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">getCluster</span><span class="p">(</span><span class="n">anime_id</span><span class="p">,</span> <span class="n">opposite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">opposite</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">anime_id</span><span class="p">][</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">clusterID</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">clusters</span><span class="p">[</span><span class="n">clusterID</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">anime_id</span><span class="p">][</span><span class="s1">&#39;zeta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">clusterID</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">clusters</span><span class="p">[</span><span class="n">clusterID</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_formater</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;inputFormater.csv&quot;</span><span class="p">)</span>
<span class="n">input_formater</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gender</th>
      <th>Category2</th>
      <th>Category3</th>
      <th>Category4</th>
      <th>Category5</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UserVector</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">uratings</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">age</span><span class="o">&lt;</span><span class="mi">11</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">age</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="n">age</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="o">=</span><span class="mi">5</span>

        <span class="k">if</span> <span class="n">gender</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;male&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gender</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gender</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">input_formater</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gender</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">aniId_to_ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">aniId</span> <span class="ow">in</span> <span class="n">uratings</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">aniId</span><span class="p">)]</span> <span class="o">=</span> <span class="n">uratings</span><span class="p">[</span><span class="n">aniId</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span>  <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="n">user_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">user_vector</span>

    <span class="k">def</span> <span class="nf">get_anime_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">anime_to_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aniId_to_ind</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ani_genre</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;anime_genres.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ani_genre</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>anime_id</th>
      <th>Sports</th>
      <th>Parody</th>
      <th>Mecha</th>
      <th>Cars</th>
      <th>Dementia</th>
      <th>Slice of Life</th>
      <th>Mystery</th>
      <th>Horror</th>
      <th>Super Power</th>
      <th>Magic</th>
      <th>Demons</th>
      <th>Shoujo</th>
      <th>Space</th>
      <th>Military</th>
      <th>Seinen</th>
      <th>Action</th>
      <th>Music</th>
      <th>Vampire</th>
      <th>Historical</th>
      <th>Game</th>
      <th>Harem</th>
      <th>Samurai</th>
      <th>Sci-Fi</th>
      <th>Psychological</th>
      <th>Josei</th>
      <th>Ecchi</th>
      <th>Comedy</th>
      <th>Fantasy</th>
      <th>School</th>
      <th>Yuri</th>
      <th>Adventure</th>
      <th>Drama</th>
      <th>Kids</th>
      <th>Hentai</th>
      <th>Shounen</th>
      <th>Thriller</th>
      <th>Romance</th>
      <th>Shoujo Ai</th>
      <th>Supernatural</th>
      <th>Police</th>
      <th>Yaoi</th>
      <th>Martial Arts</th>
      <th>Shounen Ai</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11013</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2104</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5262</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>721</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12365</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get similar anime</span>
<span class="k">def</span> <span class="nf">similarAnime</span><span class="p">(</span><span class="n">uratings</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">):</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uratings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">anime_data</span> <span class="o">=</span> <span class="n">all_anime</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;anime_id&#39;</span><span class="p">)</span>

        <span class="n">top_animes</span><span class="p">(</span><span class="s1">&#39;Shounen&#39;</span><span class="p">,</span> <span class="n">ani_genre</span><span class="p">,</span> <span class="n">anime_data</span><span class="p">)</span>
        <span class="n">top_animes</span><span class="p">(</span><span class="s1">&#39;Supernatural&#39;</span><span class="p">,</span> <span class="n">ani_genre</span><span class="p">,</span> <span class="n">anime_data</span><span class="p">)</span>
        <span class="n">top_animes</span><span class="p">(</span><span class="s1">&#39;Romance&#39;</span><span class="p">,</span> <span class="n">ani_genre</span><span class="p">,</span> <span class="n">anime_data</span><span class="p">)</span>
        <span class="n">top_animes</span><span class="p">(</span><span class="s1">&#39;Slice of Life&#39;</span><span class="p">,</span> <span class="n">ani_genre</span><span class="p">,</span> <span class="n">anime_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">uratings</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="n">SimilarAnime</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">SimilarAnime</span> <span class="o">+=</span> <span class="n">getCluster</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opposite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">SimilarAnime</span> <span class="o">+=</span> <span class="n">getCluster</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">opposite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">SimilarAnime</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get Anime You May Like</span>
<span class="k">def</span> <span class="nf">animeYouMayLike</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">uratings</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">,</span> <span class="n">aniId_to_index</span><span class="p">):</span>
    <span class="c1"># Get Similar Anime</span>
    <span class="n">SimilarAnime</span> <span class="o">=</span> <span class="n">similarAnime</span><span class="p">(</span><span class="n">uratings</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SimilarAnime</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>
    
    <span class="c1"># User Data Column</span>
    <span class="n">user_data</span> <span class="o">=</span> <span class="n">UserVector</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">uratings</span><span class="p">)</span>

    <span class="c1"># User Data Loader</span>
    <span class="n">user_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">user_data</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Get model Predictions</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getPredictedRatings</span><span class="p">(</span><span class="n">user_data</span><span class="p">,</span> <span class="n">user_dl</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Get top predicted anime</span>
    <span class="n">animes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">animes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">user_data</span><span class="o">.</span><span class="n">get_anime_id</span><span class="p">,</span> <span class="n">animes</span><span class="p">))</span>

    <span class="c1"># Generate &#39;Similar Anime&#39; and &#39;Anime You May Like&#39;</span>
    <span class="n">FinalList1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">FinalList2</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">aniID</span> <span class="ow">in</span> <span class="n">animes</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">aniId_to_index</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">aniID</span><span class="p">])</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">aniID</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;title_english&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">],</span> <span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;genre&#39;</span><span class="p">][</span><span class="n">index</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">aniID</span> <span class="ow">in</span> <span class="n">SimilarAnime</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">FinalList1</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">aniID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uratings</span><span class="p">:</span>
            <span class="n">FinalList1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">aniID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SimilarAnime</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">FinalList2</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">10</span> <span class="ow">and</span> <span class="n">aniID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uratings</span><span class="p">:</span>
            <span class="n">FinalList2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">FinalList1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">FinalList2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">FinalList1</span><span class="p">,</span> <span class="n">FinalList2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">showRecommendations</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">uratings</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">,</span> <span class="n">aniId_to_index</span><span class="p">):</span>
    <span class="c1"># Get both the lists</span>
    <span class="n">List1</span><span class="p">,</span> <span class="n">List2</span> <span class="o">=</span> <span class="n">animeYouMayLike</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">uratings</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">,</span> <span class="n">aniId_to_index</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">List1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">List2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    
    <span class="c1"># Tabulate the Results</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;similar Anime&quot;</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">List1</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Anime ID&#39;</span><span class="p">,</span> <span class="s1">&#39;JP Title&#39;</span><span class="p">,</span> <span class="s1">&#39;EN Title&#39;</span><span class="p">,</span> <span class="s1">&#39;Genre&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Anime You May Like&quot;</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">List2</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Anime ID&#39;</span><span class="p">,</span> <span class="s1">&#39;JP Title&#39;</span><span class="p">,</span> <span class="s1">&#39;EN Title&#39;</span><span class="p">,</span> <span class="s1">&#39;Genre&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;orgtbl&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="autoencoder-model">
<h2>Autoencoder model<a class="headerlink" href="#autoencoder-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">activation</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
  
    <span class="k">if</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;selu&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">selu</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;elu&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">elu</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;relu&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;relu6&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">relu6</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;lrelu&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">leaky_relu</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;tanh&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;swish&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span><span class="o">*</span><span class="nb">input</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;identity&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">input</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown non-Linearity Type&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AutoEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_sizes</span><span class="p">,</span> <span class="n">nl_type</span><span class="o">=</span><span class="s1">&#39;selu&#39;</span><span class="p">,</span> <span class="n">is_constrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dp_drop_prob</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">last_layer_activations</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">(</span><span class="n">AutoEncoder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">layer_sizes</span> <span class="o">=</span> <span class="n">layer_sizes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nl_type</span> <span class="o">=</span> <span class="n">nl_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_constrained</span> <span class="o">=</span> <span class="n">is_constrained</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dp_drop_prob</span> <span class="o">=</span> <span class="n">dp_drop_prob</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_layer_activations</span> <span class="o">=</span> <span class="n">last_layer_activations</span>

    <span class="k">if</span> <span class="n">dp_drop_prob</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">drop</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dp_drop_prob</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_last</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>

    <span class="c1"># Initaialize Weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_weights</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterList</span><span class="p">(</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="p">]</span> <span class="p">)</span>

    <span class="c1"># &quot;Xavier Initialization&quot; ( Understanding the Difficulty in training deep feed forward neural networks - by Glorot, X. &amp; Bengio, Y. )</span>
    <span class="c1"># ( Values are sampled from uniform distribution )</span>
    <span class="k">for</span> <span class="n">weights</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder_weights</span><span class="p">:</span>
      <span class="n">init</span><span class="o">.</span><span class="n">xavier_uniform_</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Encoder Bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterList</span><span class="p">(</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>

    <span class="n">reverse_layer_sizes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">layer_sizes</span><span class="p">))</span> 
    <span class="c1"># reversed returns iterator</span>

    <span class="c1"># Decoder Weights</span>
    <span class="k">if</span> <span class="n">is_constrained</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">decoder_weights</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterList</span><span class="p">(</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">reverse_layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse_layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reverse_layer_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>

      <span class="k">for</span> <span class="n">weights</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_weights</span><span class="p">:</span>
        <span class="n">init</span><span class="o">.</span><span class="n">xavier_uniform_</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">decoder_bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ParameterList</span><span class="p">(</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">reverse_layer_sizes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reverse_layer_sizes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>



  <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_weights</span><span class="p">):</span>
      <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder_bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
      <span class="n">x</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nl_type</span><span class="p">)</span>

    <span class="c1"># Apply Dropout on the last layer</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dp_drop_prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>


  <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constrained</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
      <span class="c1"># Weights are tied</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_weights</span><span class="p">)),</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_weights</span><span class="p">))):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_bias</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nl_type</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_layer_activations</span> <span class="k">else</span> <span class="s1">&#39;relu&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

      <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decoder_weights</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder_weights</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nl_type</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_layer_activations</span> <span class="k">else</span> <span class="s1">&#39;relu&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span>

  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># Forward Pass</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PredictionEngine</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6673</span><span class="p">,</span> <span class="mi">8192</span><span class="p">,</span> <span class="mi">2048</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">AutoEncoder</span><span class="p">(</span><span class="n">layer_sizes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_sizes</span><span class="p">,</span> <span class="n">nl_type</span><span class="o">=</span><span class="s1">&#39;selu&#39;</span><span class="p">,</span> <span class="n">is_constrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dp_drop_prob</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">last_layer_activations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;autoEncoder.pth&#39;</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

  <span class="k">def</span> <span class="nf">getPredictedRatings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_dat</span><span class="p">,</span> <span class="n">user_dl</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">user_dl</span><span class="p">:</span>
      <span class="n">inputs</span> <span class="o">=</span> <span class="n">data</span>
      <span class="k">try</span><span class="p">:</span>
          <span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
      <span class="k">except</span><span class="p">:</span>
          <span class="k">pass</span>
      <span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

      <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
      <span class="k">break</span>

    <span class="k">return</span> <span class="n">outputs</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Search anime in database</span>
<span class="k">def</span> <span class="nf">find_anime</span><span class="p">(</span><span class="n">input_anime</span><span class="p">,</span> <span class="n">name_to_id</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Anime Id&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Title&#39;</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">name_to_id</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">input_anime</span> <span class="ow">in</span> <span class="n">n</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">name_to_id</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flag</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-cleaned-dataset">
<h2>Load cleaned dataset<a class="headerlink" href="#load-cleaned-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load all the datasets</span>
<span class="n">all_anime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;anime_cleaned.csv&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">all_anime</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>anime_id</th>
      <th>title</th>
      <th>title_english</th>
      <th>title_japanese</th>
      <th>title_synonyms</th>
      <th>image_url</th>
      <th>type</th>
      <th>source</th>
      <th>episodes</th>
      <th>status</th>
      <th>airing</th>
      <th>aired_string</th>
      <th>aired</th>
      <th>duration</th>
      <th>rating</th>
      <th>score</th>
      <th>scored_by</th>
      <th>rank</th>
      <th>popularity</th>
      <th>members</th>
      <th>favorites</th>
      <th>background</th>
      <th>premiered</th>
      <th>broadcast</th>
      <th>related</th>
      <th>producer</th>
      <th>licensor</th>
      <th>studio</th>
      <th>genre</th>
      <th>opening_theme</th>
      <th>ending_theme</th>
      <th>duration_min</th>
      <th>aired_from_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11013</td>
      <td>Inu x Boku SS</td>
      <td>Inu X Boku Secret Service</td>
      <td>妖狐×僕SS</td>
      <td>Youko x Boku SS</td>
      <td>https://myanimelist.cdn-dena.com/images/anime/...</td>
      <td>TV</td>
      <td>Manga</td>
      <td>12</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>Jan 13, 2012 to Mar 30, 2012</td>
      <td>{'from': '2012-01-13', 'to': '2012-03-30'}</td>
      <td>24 min. per ep.</td>
      <td>PG-13 - Teens 13 or older</td>
      <td>7.63</td>
      <td>139250</td>
      <td>1274.0</td>
      <td>231</td>
      <td>283882</td>
      <td>2809</td>
      <td>Inu x Boku SS was licensed by Sentai Filmworks...</td>
      <td>Winter 2012</td>
      <td>Fridays at Unknown</td>
      <td>{'Adaptation': [{'mal_id': 17207, 'type': 'man...</td>
      <td>Aniplex, Square Enix, Mainichi Broadcasting Sy...</td>
      <td>Sentai Filmworks</td>
      <td>David Production</td>
      <td>Comedy, Supernatural, Romance, Shounen</td>
      <td>['"Nirvana" by MUCC']</td>
      <td>['#1: "Nirvana" by MUCC (eps 1, 11-12)', '#2: ...</td>
      <td>24.0</td>
      <td>2012.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2104</td>
      <td>Seto no Hanayome</td>
      <td>My Bride is a Mermaid</td>
      <td>瀬戸の花嫁</td>
      <td>The Inland Sea Bride</td>
      <td>https://myanimelist.cdn-dena.com/images/anime/...</td>
      <td>TV</td>
      <td>Manga</td>
      <td>26</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>Apr 2, 2007 to Oct 1, 2007</td>
      <td>{'from': '2007-04-02', 'to': '2007-10-01'}</td>
      <td>24 min. per ep.</td>
      <td>PG-13 - Teens 13 or older</td>
      <td>7.89</td>
      <td>91206</td>
      <td>727.0</td>
      <td>366</td>
      <td>204003</td>
      <td>2579</td>
      <td>NaN</td>
      <td>Spring 2007</td>
      <td>Unknown</td>
      <td>{'Adaptation': [{'mal_id': 759, 'type': 'manga...</td>
      <td>TV Tokyo, AIC, Square Enix, Sotsu</td>
      <td>Funimation</td>
      <td>Gonzo</td>
      <td>Comedy, Parody, Romance, School, Shounen</td>
      <td>['"Romantic summer" by SUN&amp;LUNAR']</td>
      <td>['#1: "Ashita e no Hikari (明日への光)" by Asuka Hi...</td>
      <td>24.0</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5262</td>
      <td>Shugo Chara!! Doki</td>
      <td>Shugo Chara!! Doki</td>
      <td>しゅごキャラ！！どきっ</td>
      <td>Shugo Chara Ninenme, Shugo Chara! Second Year</td>
      <td>https://myanimelist.cdn-dena.com/images/anime/...</td>
      <td>TV</td>
      <td>Manga</td>
      <td>51</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>Oct 4, 2008 to Sep 25, 2009</td>
      <td>{'from': '2008-10-04', 'to': '2009-09-25'}</td>
      <td>24 min. per ep.</td>
      <td>PG - Children</td>
      <td>7.55</td>
      <td>37129</td>
      <td>1508.0</td>
      <td>1173</td>
      <td>70127</td>
      <td>802</td>
      <td>NaN</td>
      <td>Fall 2008</td>
      <td>Unknown</td>
      <td>{'Adaptation': [{'mal_id': 101, 'type': 'manga...</td>
      <td>TV Tokyo, Sotsu</td>
      <td>NaN</td>
      <td>Satelight</td>
      <td>Comedy, Magic, School, Shoujo</td>
      <td>['#1: "Minna no Tamago (みんなのたまご)" by Shugo Cha...</td>
      <td>['#1: "Rottara Rottara (ロッタラ ロッタラ)" by Buono! ...</td>
      <td>24.0</td>
      <td>2008.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>721</td>
      <td>Princess Tutu</td>
      <td>Princess Tutu</td>
      <td>プリンセスチュチュ</td>
      <td>NaN</td>
      <td>https://myanimelist.cdn-dena.com/images/anime/...</td>
      <td>TV</td>
      <td>Original</td>
      <td>38</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>Aug 16, 2002 to May 23, 2003</td>
      <td>{'from': '2002-08-16', 'to': '2003-05-23'}</td>
      <td>16 min. per ep.</td>
      <td>PG-13 - Teens 13 or older</td>
      <td>8.21</td>
      <td>36501</td>
      <td>307.0</td>
      <td>916</td>
      <td>93312</td>
      <td>3344</td>
      <td>Princess Tutu aired in two parts. The first pa...</td>
      <td>Summer 2002</td>
      <td>Fridays at Unknown</td>
      <td>{'Adaptation': [{'mal_id': 1581, 'type': 'mang...</td>
      <td>Memory-Tech, GANSIS, Marvelous AQL</td>
      <td>ADV Films</td>
      <td>Hal Film Maker</td>
      <td>Comedy, Drama, Magic, Romance, Fantasy</td>
      <td>['"Morning Grace" by Ritsuko Okazaki']</td>
      <td>['"Watashi No Ai Wa Chiisaikeredo" by Ritsuko ...</td>
      <td>16.0</td>
      <td>2002.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12365</td>
      <td>Bakuman. 3rd Season</td>
      <td>Bakuman.</td>
      <td>バクマン。</td>
      <td>Bakuman Season 3</td>
      <td>https://myanimelist.cdn-dena.com/images/anime/...</td>
      <td>TV</td>
      <td>Manga</td>
      <td>25</td>
      <td>Finished Airing</td>
      <td>False</td>
      <td>Oct 6, 2012 to Mar 30, 2013</td>
      <td>{'from': '2012-10-06', 'to': '2013-03-30'}</td>
      <td>24 min. per ep.</td>
      <td>PG-13 - Teens 13 or older</td>
      <td>8.67</td>
      <td>107767</td>
      <td>50.0</td>
      <td>426</td>
      <td>182765</td>
      <td>2082</td>
      <td>NaN</td>
      <td>Fall 2012</td>
      <td>Unknown</td>
      <td>{'Adaptation': [{'mal_id': 9711, 'type': 'mang...</td>
      <td>NHK, Shueisha</td>
      <td>NaN</td>
      <td>J.C.Staff</td>
      <td>Comedy, Drama, Romance, Shounen</td>
      <td>['#1: "Moshimo no Hanashi (もしもの話)" by nano.RIP...</td>
      <td>['#1: "Pride on Everyday" by Sphere (eps 1-13)...</td>
      <td>24.0</td>
      <td>2012.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_anime</span><span class="o">.</span><span class="n">image_url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;https://myanimelist.cdn-dena.com/images/anime/12/35893.jpg&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="k">def</span> <span class="nf">id_to_image</span><span class="p">(</span><span class="n">anime_id</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">all_anime</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">anime_id</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
  <span class="n">url</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://cdn.myanimelist.net&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">url</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
  <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">id_to_image</span><span class="p">(</span><span class="mi">12365</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T845186_Anime_Recommender_29_0.png" src="../_images/T845186_Anime_Recommender_29_0.png" />
</div>
</div>
</div>
<div class="section" id="japanese-to-english-translated-titles">
<h2>Japanese to english translated titles<a class="headerlink" href="#japanese-to-english-translated-titles" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_anime_small</span> <span class="o">=</span> <span class="n">all_anime</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">translator</span> <span class="o">=</span> <span class="n">google_translator</span><span class="p">()</span>
<span class="n">all_anime_small</span><span class="p">[</span><span class="s1">&#39;title_english_new&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_anime_small</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">translator</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">title_japanese</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">all_anime_small</span><span class="o">.</span><span class="n">title_english_new</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;&lt;Harmony /&gt; Harmony &#39;,
       &#39;Pocket Monster Diamond &amp; Pearl Dialga VS Parcia VS Dur Cry &#39;,
       &#39;Tokiwa coming! &#39;,
       &#39;Crayon Shin-chan Cho ~ Hero of the Cold Call Calling a Storm &#39;,
       &#39;Aim for the top! &amp; Top 2! Combine Movie version !! &#39;,
       &#39;Great Teacher Onida &#39;, &#39;White album &#39;, &#39;Fruit 5 sisters &#39;,
       &#39;Love, Chunibyo &amp; Other Delusions! Depth of Field ~ Love and Hatred Theater &#39;,
       &#39;Manipulate Dreamnote &#39;,
       &quot;Dragon Ball Genie Castle&#39;s Sleeve Princess &quot;, &#39;Angel cup &#39;,
       &#39;Attack on Titan Omnibus &quot;From that day&quot; &#39;, &#39;Fire bird 鳳 編 編 &#39;,
       &quot;Pikachu&#39;s sparkling! &quot;, &#39;Eye Shield 21 Phantom Golden Bowl &#39;,
       &#39;Giant God Gogue &lt;Giant Gogg&gt; &#39;, &#39;My wife is a magic girl &#39;,
       &#39;Sengoku Musou SP Sanada chapter &#39;,
       &#39;Wolf Fafner Right of Left ~ Single Program ~ &#39;,
       &#39;ef - a tale of memories. ~prologue~ &#39;,
       &#39;Galactic Hero Legend: My Conqueries of the Stars &#39;,
       &#39;Yuuki Yuki is a brave &#39;, &#39;I enjoyed the firefly &#39;,
       &#39;OKAWARI-BOY Starzan S &#39;, &#39;Pretty Girls Squadron Battle Skipper &#39;,
       &quot;Digimon Adventure 02 Deer Bellomon&#39;s Counterattack &quot;,
       &#39;Sixteen sword &#39;, &#39;DRIFTERS &#39;, &quot;Mori&#39;s apron &quot;, &#39;Sakura capsule &#39;,
       &#39;Maria looks like-spring ~ &#39;, &quot;And it&#39;s ×! &quot;, &#39;Negima! &#39;,
       &#39;Movie Crayon Shin-chan Very! Kung Fu Boys-Large Noodles Large &#39;,
       &#39;Dance with Devils &#39;, &#39;Akikan! Kang Shiroki!? Hot spring panic &#39;,
       &#39;Blackstra &#39;, &#39;Ala Ta Kangatari-Leather Gods- &#39;,
       &#39;Tales of Symphonia Tece Ala Hen again-I want to journal of laughing! ~ &#39;,
       &#39;Lady Lady! ! &#39;, &#39;Cyborg 009 &#39;, &#39;Astronomical method &#39;,
       &#39;Michiko and hatchin &#39;, &#39;2nd &#39;,
       &#39;Sin Seven Great Sin Short Animation &quot;Confession&quot; &#39;,
       &#39;ARISE -GHOST in The Shell- Border: 2 Ghost Whispers &#39;,
       &#39;Movie Pretty Cure All Stars DX2 Hope Light ☆ Protect Rainbage Eell! &#39;,
       &#39;Kanedaichi Shonen Case Book R [Returns] &#39;, &#39;Curtain ROCK &#39;,
       &#39;Money Wars Target Waterfront Planning &#39;,
       &#39;It is important for magic &#39;,
       &#39;Back of important family, its hands. &#39;,
       &#39;Dangan Ronpa 3-The End Of Yuki Mine Gakuen-Hope Hen &#39;,
       &quot;Morino&#39;s rice tough &quot;, &#39;Mob Psycho 100 &#39;,
       &#39;St. Liman Sisters Pacopaco Diary The Animation &#39;, &#39;August 26th &#39;,
       &quot;Movie version Magical Girl Madoka ☆ Magica Rebellion&#39;s Story &quot;,
       &#39;Break blade &#39;, &quot;Urawa&#39;s style &quot;,
       &#39;Gakuen Apocalypse HighSchool of the Dead Drifters of the Dead &#39;,
       &#39;UNICO &#39;, &#39;Maid either &#39;, &#39;Super Short Comics &#39;,
       &#39;Wind Invitation &#39;, &#39;Minamakebetsu &#39;, &#39;Rainyman &#39;,
       &#39;Machine Hayabusa &#39;, &#39;Castle Fantasia-Holy Dairy War ~ &#39;,
       &#39;ONE ~ To the sparkling season ~ True Stories &#39;,
       &#39;Mahoromo Summer TV Special &#39;,
       &#39;Tamagotchi! × World Conquest in Tamagotchi &#39;,
       &#39;Ponko Tsuranda Saga &#39;, &#39;Golden Corda BLUE ♪ SKY &#39;, &#39;Azuki-chan &#39;,
       &#39;Movie version Boundaries-I &amp; # 039; LL BE HERE-Postcards &quot;Promise Bonds&quot; Dance PV &#39;,
       &#39;TWO-MIX: WHITE REFLECTION &#39;, &#39;Dimension loop &#39;,
       &#39;Make love to me seriously! &#39;,
       &#39;Gregory Horror Show-The Blode Karte &#39;,
       &#39;Knights Busters Corporation &#39;, &#39;Shimoon &#39;,
       &#39;Ryuga Seven Reservations SD Character Short Movie &#39;,
       &#39;Jungle Great Emperor &#39;, &#39;Chimonal &#39;, &#39;Amanatsu &#39;,
       &#39;Fighting Legend A genius who danced in Akagi darkness &#39;,
       &#39;Gate key paz 21 &#39;, &#39;Golden Hero Gordran &#39;, &#39;Battery Larline &#39;,
       &#39;Mobile Suit Gundam 00 &#39;,
       &#39;Ilike Ichi-Lecti, a candidate for an empty battle &#39;,
       &#39;Hipila-kun &#39;,
       &#39;Detective Conan episode ONE smaller the detective &#39;,
       &#39;Laughing target &#39;, &#39;At the center of the blue world &#39;,
       &#39;Ng Knight ムネ ムネ &amp; 40 &#39;, &#39;Witch Hunter ROBIN &#39;, &#39;Acupuncturist &#39;,
       &#39;Junjo Girl Etosetra &#39;, &#39;Arcade gamer fluctu &#39;,
       &#39;Flame Alpenrose Judy &amp; Randy &#39;, &#39;Ultrasonic Warrior Bogman &#39;,
       &#39;&quot;Devilman Crybaby&quot; digest video &#39;,
       &#39;Durarara !! × 2 Appendix 4.5 episodes &quot;My heart is pot task&quot; &#39;,
       &#39;Nostalgic children &#39;, &#39;Sendaruta superstan shell orion &#39;,
       &#39;Nyanpuku Nyaruma &#39;, &#39;Rhodes Island Senki Heroes Knight &#39;,
       &#39;Magical play: jumping out !! Hanamaru Great Adventure &#39;,
       &#39;Galactic Hero Legend Gaiden Helical Labyrinth &#39;,
       &#39;Brake angel -Infinity- &#39;,
       &#39;Tengen breakthrough Glen Lagan Kirameki ★ Yoko BOX ~ Pieces of Sweet STARS ~ &#39;,
       &#39;Tegami Gakuen &#39;, &#39;Bible Black Only Edition &#39;,
       &#39;Hackle Berry Fin Story &#39;,
       &#39;DR. Slan!! Summer vacation of exciting heart &#39;,
       &quot;Harmern&#39;s violin play &quot;, &#39;Sweet Valerian &#39;, &#39;Tomb &#39;,
       &#39;Break the magic &#39;, &#39;Code Geass Lelouch of the Rebellion &#39;,
       &#39;Crayon Shin-chan &#39;, &#39;Vaulter! ! Matsutaro &#39;, &#39;Bakemono child &#39;,
       &#39;ACCA 13 District Supervision Class &#39;, &#39;Douro Continent &#39;,
       &#39;Secret Association Claws Provided Operation Operation Operation Meeting &#39;,
       &#39;Mobile Battleship Nadesico The Prince of Darkness &#39;,
       &#39;Initials &lt;Initial&gt; D Battle STAGE &#39;,
       &#39;Phantom 〜Requiem for the Phantom〜 &#39;, &#39;Hidamari sketch &#39;,
       &#39;Rozen Maiden Aubertew &#39;, &#39;Naruto Shippuden &#39;,
       &#39;Gokujo. ~ Pole Late Women High Dormitory Story ~ &#39;,
       &#39;Movie version Detective Conan 11th striker &#39;, &#39;Good luck &#39;,
       &#39;Nyar Ani Members My Love (Kraft Teacher) &#39;,
       &#39;SIN Seven Great Sins Episode 4.5 &quot;The Devil\&#39;s Office ...&quot; &#39;,
       &#39;Ryu Oto! &#39;, &quot;Fi Brain ~ God&#39;s Puzzle Envades! Rayzel &quot;,
       &#39;Tsukiuta. The Animation &#39;, &#39;Speed grapher &#39;, &#39;Giant killing &#39;,
       &#39;CODE-E &#39;, &#39;Youth × machine gun &#39;, &#39;Miracle Girl Limit &#39;,
       &#39;Spring girl &#39;, &#39;Sea tristia &#39;, &#39;Carnival &#39;, &#39;Night shift ward &#39;,
       &#39;Nontan &#39;, &#39;Health, (Hells Angels) &#39;, &#39;U-う 日 日 &#39;,
       &#39;Star Driver Shine tact &#39;, &#39;Pokemon Phantom Pokemon Lugia Bomb &#39;,
       &#39;Maiden is in love with me &#39;, &#39;Taishida Mobius Line Chitty &#39;,
       &#39;My sister and its friends are too erotic and my crotch is Yabai &#39;,
       &#39;School Girl Strikers Animation Channel &#39;,
       &#39;Tokyo Gaple Tourgul [Pinto] &#39;, &#39;Black Jack Movie version &#39;,
       &#39;Three villains of Time Bokan Counterattack &#39;, &#39;Young trees &#39;,
       &#39;Akikan! &#39;, &#39;A story from &quot;glorious genius&quot; &#39;, &#39;My three sisters &#39;,
       &#39;ARISE -GHOST in the shell- border: 3 ghost tears &#39;,
       &#39;Nano core dusk &#39;, &#39;Seto bride OVA &#39;, &#39;Grave &#39;, &#39;Budget &#39;,
       &#39;Tutor Hitman REBORN! Bongolemile Total appeared! Bongolian scholarship trip, coming !! &#39;,
       &#39;Tomo with animation DVD 1.5 volumes &#39;,
       &#39;Service of Victoria Made Maria &#39;,
       &#39;Movie Doraemon Nobita Mermaid Battle &#39;,
       &#39;Click here for Katsushika-ku Kameni Park in front of the park-The final day Batsu Mitsuyoshi last day- &#39;,
       &quot;Movie Doraemon Nobita&#39;s Antarctic Kachikuchi Great Adventure &quot;,
       &#39;There is no money &#39;,
       &quot;Idrish Seven Special Program Don&#39;t look back! &quot;, &#39;Osomatsu &#39;,
       &#39;Fire Journey [Fire Force] Dana Site 999.9 [Fourenain] &#39;,
       &#39;Mobile Suit Gundam &#39;, &#39;Yona &#39;,
       &#39;Double-tailed Petit BD &amp; DVD Vol.1 Release Commemorative Hen &#39;,
       &#39;Wakaco sake &#39;, &#39;One Piece! Pirate Baseball King &#39;,
       &#39;Aim for the top 2! Diebuster &#39;, &#39;Dragon Kotaro &#39;,
       &#39;Umi things-Coto that you got &#39;, &#39;Fafner Dead Aggressor Exodus &#39;,
       &#39;Super-grave Gravion &#39;, &#39;Copeperion &#39;,
       &#39;Super Health Century Orgas &#39;, &#39;A sunday without God &#39;,
       &#39;Ganslinger Girl-I L TEATRINO-OVA &#39;, &#39;Siri-pink &#39;,
       &#39;A Channel + SMILE (Plus Smile) &#39;, &#39;ORANGE (orange) &#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name_to_id</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">]),</span> <span class="n">index</span><span class="o">=</span><span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="n">aniId_to_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">all_anime</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">all_anime</span><span class="p">[</span><span class="s1">&#39;anime_id&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-time-process">
<h2>Run time process<a class="headerlink" href="#run-time-process" title="Permalink to this headline">¶</a></h2>
<img src='https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4bb0941a-bdc2-4405-a471-d194823374ed%2FUntitled.png?table=block&id=96499a3d-1b91-4d78-a81f-3155f801370c&spaceId=63b72b1f-0e90-4ab8-a6df-a060a6545a56&width=2000&userId=21ec183f-f0be-4b6b-9b3e-6f0d4e5c5469&cache=v2'></div>
<div class="section" id="hybrid-filter">
<h2>Hybrid filter<a class="headerlink" href="#hybrid-filter" title="Permalink to this headline">¶</a></h2>
<img src='https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F749f3415-9216-441b-8efe-b3bebc668688%2FUntitled.png?table=block&id=ca33cfb1-46fe-4feb-a614-def17759f551&spaceId=63b72b1f-0e90-4ab8-a6df-a060a6545a56&width=2000&userId=21ec183f-f0be-4b6b-9b3e-6f0d4e5c5469&cache=v2'></div>
<div class="section" id="run-time">
<h2>Run time<a class="headerlink" href="#run-time" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Load the AutoEncoder</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PredictionEngine</span><span class="p">()</span>

<span class="c1"># Get basic information from the user</span>
<span class="n">age</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter Age: &quot;</span><span class="p">))</span>
<span class="n">gender</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter Gender (Male/Female): &quot;</span><span class="p">)</span>
<span class="n">input_ratings</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

<span class="c1"># Let the user rate some animes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">It is recommended to rate atleast 5 animes in the beginning.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note:- Currently search mechanism searches for anime using the Japanese Title only.&quot;</span><span class="p">)</span>

<span class="c1"># List for storing the user ratings of recommended table</span>
<span class="n">user_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Start the recommendation process</span>
<span class="n">k1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Start the process? [y/n]: &quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="n">k1</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">k1</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>

    <span class="c1"># If user want to search and rate</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Search and rate? [y/n]: &quot;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">k2</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">k2</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span>
        <span class="k">while</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">or</span> <span class="n">p</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
            <span class="n">input_anime</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter Anime title: &quot;</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="n">find_anime</span><span class="p">(</span><span class="n">input_anime</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">name_to_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">flag</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Anime not found in dataset. Please try searching only a part of the title or another anime!!&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Anime found? [y/n]: &quot;</span><span class="p">)</span>

        <span class="n">aniId</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter anime id: &quot;</span><span class="p">))</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Your rating (1 - 10): &quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
              <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Only integers are allowed&quot;</span><span class="p">)</span>
              
        <span class="n">input_ratings</span><span class="p">[</span><span class="n">aniId</span><span class="p">]</span> <span class="o">=</span> <span class="n">rate</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Search and rate more? [y/n]: &quot;</span><span class="p">)</span>

    <span class="c1"># Main Game</span>
    <span class="n">showRecommendations</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">gender</span><span class="p">,</span> <span class="n">input_ratings</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">all_anime</span><span class="p">,</span> <span class="n">aniId_to_index</span><span class="p">)</span>

    <span class="c1"># If user want to rate anime from above list</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Rate anime from above list? [y/n]:&quot;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">k2</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">k2</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
        <span class="n">aniId</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter anime id: &quot;</span><span class="p">))</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Your rating (1 - 10): &quot;</span><span class="p">))</span>
        <span class="n">input_ratings</span><span class="p">[</span><span class="n">aniId</span><span class="p">]</span> <span class="o">=</span> <span class="n">rate</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Rate again from above list? [y/n]: &quot;</span><span class="p">)</span>

    <span class="n">k2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Your score for the table of recommended anime (1 - 10):&quot;</span><span class="p">))</span>
    <span class="n">user_score</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="n">k2</span><span class="p">])</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">k1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Keep going? [y/n]: &quot;</span><span class="p">)</span>

<span class="c1"># Displaying the user score over iterations</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Table of user scores&#39;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">tabulate</span><span class="p">(</span><span class="n">user_score</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Iterations&#39;</span><span class="p">,</span> <span class="s1">&#39;User Score&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting...

Enter Age: 25
Enter Gender (Male/Female): Male

It is recommended to rate atleast 5 animes in the beginning.
Note:- Currently search mechanism searches for anime using the Japanese Title only.

Start the process? [y/n]: y

Search and rate? [y/n]: y
Enter Anime title: magic
Anime Id 	 Title
33358 	 Mahou no Star Magical Emi: Finale! Finale!
23831 	 Mahou Shoujo Madoka★Magica Movie 3: Hangyaku no Monogatari - Magica Quartet x Nisioisin
2038 	 Mahou no Star Magical Emi
30030 	 Jewelpet Magical Change
5080 	 Quiz Magic Academy: The Original Animation
4017 	 Magical Moe
36760 	 Detective Conan: The Magician of Starlight
8443 	 Mahou no Star Magical Emi: Semishigure
941 	 Renkin San-kyuu Magical? Pokaan
34104 	 Knight&amp;#039;s &amp; Magic
1367 	 Detective Conan Movie 08: Magician of the Silver Sky
17725 	 Magical☆Star Kanon 100%
11979 	 Mahou Shoujo Madoka★Magica Movie 2: Eien no Monogatari
11981 	 Mahou Shoujo Madoka★Magica Movie 3: Hangyaku no Monogatari
8310 	 Magic Kaito
1563 	 Magic Knight Rayearth II
18115 	 Magi: The Kingdom of Magic
1489 	 Renkin San-kyuu Magical? Pokaan Specials
9506 	 Prism Magical: Prism Generations!
33299 	 Magic-Kyun! Renaissance
349 	 Magical Canan
11977 	 Mahou Shoujo Madoka★Magica Movie 1: Hajimari no Monogatari
9756 	 Mahou Shoujo Madoka★Magica
10690 	 Magic Tree House
15915 	 Magical Hat
1270 	 Black Magic M-66
14513 	 Magi: The Labyrinth of Magic
435 	 Magic Knight Rayearth
25517 	 Magic Kaito 1412
7549 	 Quiz Magic Academy: The Original Animation 2
2369 	 Rental Magica
5274 	 Magical★Taruruuto-kun
15407 	 Magical Suite Prism Nana
32153 	 Mahou Shoujo Madoka★Magica: Concept Movie
Anime found? [y/n]: y
Enter anime id: 10690
Your rating (1 - 10): 7
Search and rate more? [y/n]: y
Enter Anime title: play
Anime Id 	 Title
3768 	 Play Ball
Anime found? [y/n]: y
Enter anime id: 3768
Your rating (1 - 10): 6
Search and rate more? [y/n]: y
Enter Anime title: good
Anime Id 	 Title
31699 	 Good Morning!!! Doronjo
8626 	 Good Morning
1056 	 Good Morning Call
Anime found? [y/n]: y
Enter anime id: 31699
Your rating (1 - 10): 8
Search and rate more? [y/n]: y
Enter Anime title: scare
Anime Id 	 Title
33113 	 Scared Rider Xechs
4684 	 Scarecrowman
Anime found? [y/n]: y
Enter anime id: 4684
Your rating (1 - 10): 9
Search and rate more? [y/n]: y
Enter Anime title: ice
Anime Id 	 Title
74 	 Gakuen Alice
34350 	 Alice to Zouroku
33687 	 Cyborg 009: Call of Justice 3
16021 	 Miracle Psychicer Seizan
35382 	 Yuri!!! on Ice: Yuri Plisetsky GPF in Barcelona EX - Welcome to The Madness
117 	 El Hazard: The Magnificent World
30066 	 L/R: Licensed by Royal Special
35914 	 Catchy-kun no Nice Catch!
26359 	 Persona 4 the Golden Animation: Thank you Mr. Accomplice
27969 	 Hana to Alice: Satsujin Jiken
10832 	 Ikoku Meiro no Croisée: Yune &amp; Alice
31633 	 Sushi Police
33685 	 Cyborg 009: Call of Justice 1
29317 	 Saenai Heroine no Sodatekata: Ai to Seishun no Service-kai
21305 	 Trick or Alice
1346 	 AD Police
33686 	 Cyborg 009: Call of Justice 2
36803 	 Servamp Movie: Alice in the Garden
2169 	 Ice
4713 	 Heart no Kuni no Alice: Wonderful Wonder World
35818 	 Love Kome: We Love Rice 2nd Season
1180 	 Hyper Police
36096 	 Ice Fist
32548 	 Imawa no Kuni no Alice
5646 	 Deep Voice
32995 	 Yuri!!! on Ice
2572 	 Fushigi no Kuni no Alice
34402 	 Love Kome: We Love Rice
1477 	 City Hunter: The Secret Service
1456 	 L/R: Licensed by Royal
118 	 El Hazard 2: The Magnificent World
577 	 Kagihime Monogatari Eikyuu Alice Rinbukyoku
2725 	 Tenchi Muyou!: Galaxy Police Mihoshi Space Adventure
36001 	 Alice or Alice: Siscon Niisan to Futago no Imouto
29093 	 Grisaia no Meikyuu: Caprice no Mayu 0
29837 	 Yakushiji Ryouko no Kaiki Jikenbo: Hamachou, Voice &amp; Fiction
8812 	 Alice SOS
24781 	 Imawa no Kuni no Alice (OVA)
10849 	 Shinryaku! Ika Musume: Ika Ice Tabena-ika?
2056 	 Cosmo Police Justy
35338 	 Saenai Heroine no Sodatekata ♭: Koi to Junjou no Service-kai
18119 	 Servant x Service
Anime found? [y/n]: y
Enter anime id: 2056
Your rating (1 - 10): 7
Search and rate more? [y/n]: y
Enter Anime title: play
Anime Id 	 Title
3768 	 Play Ball
Anime found? [y/n]: n
Enter Anime title: time
Anime Id 	 Title
1933 	 Growlanser IV: Wayfarer of the Time
1194 	 Coyote Ragtime Show
779 	 Detective Conan Movie 01: The Timed Skyscraper
17895 	 Golden Time
35254 	 Time Bokan: Gyakushuu no San Akunin
37665 	 Yoshida no Time Slip Fumai-kou
33341 	 Time Travel Shoujo: Mari Waka to 8-nin no Kagakusha-tachi
37051 	 Petit☆Dream Stars! Let&amp;#039;s La Cooking? Showtime!
33845 	 Free! Movie 1: Timeless Medley - Kizuna
35191 	 Free! Movie 2: Timeless Medley - Yakusoku
10178 	 Otona Joshi no Anime Time
677 	 Sentimental Journey
33142 	 Re:Zero kara Hajimeru Break Time
2820 	 Time Travel Tondekeman!
32174 	 The iDOLM@STER Cinderella Girls: Anytime, Anywhere with Cinderella.
3915 	 Time Bokan
9393 	 T.P. Sakura: Time Paladin Sakura
1689 	 Byousoku 5 Centimeter
34787 	 Idol Time PriPara
33026 	 Time Bokan 24
25491 	 Megumi to Taiyou III: Kajuu Gummi Tweet Fantasy - Timeline World
34776 	 Eureka Seven AO Final Episode: One More Time - Lord Don&amp;#039;t Slow Me Down
14991 	 Harem Time The Animation
37859 	 Free! Movie 2: Timeless Medley - Yakusoku: Character Butai Aisatsu
37858 	 Free! Movie 1: Timeless Medley - Kizuna: Character Butai Aisatsu
Anime found? [y/n]: y
Enter anime id: 37858
Your rating (1 - 10): 9
Search and rate more? [y/n]: n
similar Anime
|   Anime ID | JP Title                               | EN Title                                  | Genre                                                  |
|------------+----------------------------------------+-------------------------------------------+--------------------------------------------------------|
|       1724 | Saint October                          | nan                                       | Adventure, Fantasy                                     |
|       1771 | Ring ni Kakero 1: Nichibei Kessen-hen  | Ring ni Kakero 1 Episode: The Pacific War | Action, Sports, Shounen                                |
|       1155 | Melty Lancer                           | nan                                       | Adventure, Comedy, Sci-Fi, Space                       |
|       2723 | D4 Princess                            | nan                                       | Action, Sci-Fi, Comedy, Magic, Mecha                   |
|       8353 | Ketsuinu                               | nan                                       | Comedy                                                 |
|        980 | Rikujou Bouei-tai Mao-chan             | Ground Defense Force! Mao-chan            | Comedy, Kids, Magic, Military, Sci-Fi                  |
|       6331 | Ten Little Gall Force                  | nan                                       | Action, Military, Sci-Fi, Space, Comedy, Parody, Mecha |
|      36204 | Tokimeki Restaurant☆☆☆  MIRACLE6 Movie | nan                                       | Music, Romance                                         |
|       2781 | Saint Luminous Jogakuin                | St. Luminous Mission High School          | Mystery, Psychological, Supernatural                   |
|      15545 | Oshiri Kajiri Mushi (TV)               | Bottom Biting Bug                         | Comedy, Kids                                           |
Anime You May Like
|   Anime ID | JP Title                                       | EN Title                                | Genre                                                |
|------------+------------------------------------------------+-----------------------------------------+------------------------------------------------------|
|      30851 | Q Transformers: Saranaru Ninki Mono e no Michi | nan                                     | Slice of Life, Parody, Mecha                         |
|      33473 | Tokyo Futago Athletic                          | Tokyo Twins Athletic Tournament         | Comedy, Sports                                       |
|       5267 | Gamba no Bouken                                | Adventure of Gamba                      | Adventure, Kids                                      |
|       7308 | Mirai Shounen Conan (Movie)                    | Future Boy Conan Movie                  | Adventure, Drama, Sci-Fi                             |
|      35805 | Cinderella Girls Gekijou Specials              | THE IDOLM@STER CINDERELLA GIRLS Theater | Slice of Life, Comedy                                |
|       3281 | Kinnikuman: Kinnikusei Oui Soudatsu-hen        | nan                                     | Action, Comedy, Sports, Shounen                      |
|      16009 | Kamisama no Inai Nichiyoubi                    | Sunday Without God                      | Fantasy, Mystery                                     |
|       2092 | Kiss wa Hitomi ni Shite                        | nan                                     | Comedy, Romance, Shoujo                              |
|       7904 | Kemono no Souja Erin Recap                     | nan                                     | Adventure, Slice of Life, Historical, Drama, Fantasy |
|       1537 | Genshi Shounen Ryuu                            | Ryu the Primitive Boy                   | Action, Sci-Fi, Adventure, Romance, Shounen          |

Rate anime from above list? [y/n]:n
Your score for the table of recommended anime (1 - 10):6

Keep going? [y/n]: n


Table of user scores
+--------------+--------------+
|   Iterations |   User Score |
+==============+==============+
|            1 |            6 |
+--------------+--------------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rated_anime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10690</span><span class="p">,</span> <span class="mi">3768</span><span class="p">,</span> <span class="mi">31699</span><span class="p">,</span> <span class="mi">2056</span><span class="p">,</span> <span class="mi">37858</span><span class="p">]</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">rated_anime_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_to_image</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">rated_anime</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">columns</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rated_anime_images</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rated_anime_images</span><span class="p">)</span> <span class="o">/</span> <span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T845186_Anime_Recommender_39_0.png" src="../_images/T845186_Anime_Recommender_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">similar_anime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1724</span><span class="p">,</span> <span class="mi">1771</span><span class="p">,</span> <span class="mi">1155</span><span class="p">,</span> <span class="mi">2723</span><span class="p">,</span> <span class="mi">8353</span><span class="p">]</span>
<span class="n">similar_anime_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_to_image</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">similar_anime</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">columns</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">similar_anime_images</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">similar_anime_images</span><span class="p">)</span> <span class="o">/</span> <span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T845186_Anime_Recommender_40_0.png" src="../_images/T845186_Anime_Recommender_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">personalized_anime</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30851</span><span class="p">,</span> <span class="mi">33473</span><span class="p">,</span> <span class="mi">5267</span><span class="p">,</span> <span class="mi">7308</span><span class="p">,</span> <span class="mi">35805</span><span class="p">]</span>
<span class="n">personalized_anime_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_to_image</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">personalized_anime</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">columns</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">personalized_anime_images</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">personalized_anime_images</span><span class="p">)</span> <span class="o">/</span> <span class="n">columns</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/T845186_Anime_Recommender_41_0.png" src="../_images/T845186_Anime_Recommender_41_0.png" />
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Paper: <a class="reference external" href="https://arxiv.org/pdf/2106.12970.pdf">https://arxiv.org/pdf/2106.12970.pdf</a></p></li>
<li><p>Code: <a class="reference external" href="https://github.com/NilutpalNath/RikoNet">https://github.com/NilutpalNath/RikoNet</a></p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nbs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="T822164_movielens_milvus_redis_efficient_retrieval.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Recommender with Redis and Milvus</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="T855843_kafka_spark_streaming_colab.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Kafka and Spark Streaming in Colab</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sparsh A.<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>